(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const He=(e,t)=>e===t,Pe=Symbol("solid-track"),q={equals:He};let Fe=me;const L=1,W=2,ye={owned:null,cleanups:null,context:null,owner:null};var k=null;let se=null,m=null,x=null,O=null,Y=0;function G(e,t){const n=m,s=k,r=e.length===0,i=r?ye:{owned:null,cleanups:null,context:null,owner:t===void 0?s:t},o=r?e:()=>e(()=>_(()=>te(i)));k=i,m=null;try{return V(o,!0)}finally{m=n,k=s}}function F(e,t){t=t?Object.assign({},q,t):q;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),we(n,r));return[pe.bind(n),s]}function I(e,t,n){const s=ge(e,t,!1,L);ee(s)}function T(e,t,n){n=n?Object.assign({},q,n):q;const s=ge(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,ee(s),pe.bind(s)}function _(e){if(m===null)return e();const t=m;m=null;try{return e()}finally{m=t}}function Re(e){return k===null||(k.cleanups===null?k.cleanups=[e]:k.cleanups.push(e)),e}function Ue(e){const t=T(e),n=T(()=>ie(t()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}function pe(){if(this.sources&&this.state)if(this.state===L)ee(this);else{const e=x;x=null,V(()=>Q(this),!1),x=e}if(m){const e=this.observers?this.observers.length:0;m.sources?(m.sources.push(this),m.sourceSlots.push(e)):(m.sources=[this],m.sourceSlots=[e]),this.observers?(this.observers.push(m),this.observerSlots.push(m.sources.length-1)):(this.observers=[m],this.observerSlots=[m.sources.length-1])}return this.value}function we(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&V(()=>{for(let r=0;r<e.observers.length;r+=1){const i=e.observers[r],o=se&&se.running;o&&se.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?x.push(i):O.push(i),i.observers&&ve(i)),o||(i.state=L)}if(x.length>1e6)throw x=[],new Error},!1)),t}function ee(e){if(!e.fn)return;te(e);const t=k,n=m,s=Y;m=k=e,Oe(e,e.value,s),m=n,k=t}function Oe(e,t,n){let s;try{s=e.fn(t)}catch(r){return e.pure&&(e.state=L,e.owned&&e.owned.forEach(te),e.owned=null),e.updatedAt=n+1,Ce(r)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?we(e,s):e.value=s,e.updatedAt=n)}function ge(e,t,n,s=L,r){const i={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:k,context:null,pure:n};return k===null||k!==ye&&(k.owned?k.owned.push(i):k.owned=[i]),i}function be(e){if(e.state===0)return;if(e.state===W)return Q(e);if(e.suspense&&_(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Y);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===L)ee(e);else if(e.state===W){const s=x;x=null,V(()=>Q(e,t[0]),!1),x=s}}function V(e,t){if(x)return e();let n=!1;t||(x=[]),O?n=!0:O=[],Y++;try{const s=e();return Te(n),s}catch(s){n||(O=null),x=null,Ce(s)}}function Te(e){if(x&&(me(x),x=null),e)return;const t=O;O=null,t.length&&V(()=>Fe(t),!1)}function me(e){for(let t=0;t<e.length;t++)be(e[t])}function Q(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const r=s.state;r===L?s!==t&&(!s.updatedAt||s.updatedAt<Y)&&be(s):r===W&&Q(s,t)}}}function ve(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=W,n.pure?x.push(n):O.push(n),n.observers&&ve(n))}}function te(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const i=r.pop(),o=n.observerSlots.pop();s<r.length&&(i.sourceSlots[o]=s,r[s]=i,n.observerSlots[s]=o)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)te(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Le(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ce(e,t=k){throw Le(e)}function ie(e){if(typeof e=="function"&&!e.length)return ie(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const s=ie(e[n]);Array.isArray(s)?t.push.apply(t,s):t.push(s)}return t}return e}const Be=Symbol("fallback");function ce(e){for(let t=0;t<e.length;t++)e[t]()}function Ie(e,t,n={}){let s=[],r=[],i=[],o=0,l=t.length>1?[]:null;return Re(()=>ce(i)),()=>{let c=e()||[],f,a;return c[Pe],_(()=>{let d=c.length,v,C,A,p,u,y,b,S,E;if(d===0)o!==0&&(ce(i),i=[],s=[],r=[],o=0,l&&(l=[])),n.fallback&&(s=[Be],r[0]=G(R=>(i[0]=R,n.fallback())),o=1);else if(o===0){for(r=new Array(d),a=0;a<d;a++)s[a]=c[a],r[a]=G(g);o=d}else{for(A=new Array(d),p=new Array(d),l&&(u=new Array(d)),y=0,b=Math.min(o,d);y<b&&s[y]===c[y];y++);for(b=o-1,S=d-1;b>=y&&S>=y&&s[b]===c[S];b--,S--)A[S]=r[b],p[S]=i[b],l&&(u[S]=l[b]);for(v=new Map,C=new Array(S+1),a=S;a>=y;a--)E=c[a],f=v.get(E),C[a]=f===void 0?-1:f,v.set(E,a);for(f=y;f<=b;f++)E=s[f],a=v.get(E),a!==void 0&&a!==-1?(A[a]=r[f],p[a]=i[f],l&&(u[a]=l[f]),a=C[a],v.set(E,a)):i[f]();for(a=y;a<d;a++)a in A?(r[a]=A[a],i[a]=p[a],l&&(l[a]=u[a],l[a](a))):r[a]=G(g);r=r.slice(0,o=d),s=c.slice(0)}return r});function g(d){if(i[a]=d,l){const[v,C]=F(a);return l[a]=C,t(c[a],v)}return t(c[a])}}}function h(e,t){return _(()=>e(t||{}))}const ke=e=>`Stale read from <${e}>.`;function Ne(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(Ie(()=>e.each,e.children,t||void 0))}function le(e){const t=e.keyed,n=T(()=>e.when,void 0,{equals:(s,r)=>t?s===r:!s==!r});return T(()=>{const s=n();if(s){const r=e.children;return typeof r=="function"&&r.length>0?_(()=>r(t?s:()=>{if(!_(n))throw ke("Show");return e.when})):r}return e.fallback},void 0,void 0)}function xe(e){let t=!1;const n=(i,o)=>i[0]===o[0]&&(t?i[1]===o[1]:!i[1]==!o[1])&&i[2]===o[2],s=Ue(()=>e.children),r=T(()=>{let i=s();Array.isArray(i)||(i=[i]);for(let o=0;o<i.length;o++){const l=i[o].when;if(l)return t=!!i[o].keyed,[o,l,i[o]]}return[-1]},void 0,{equals:n});return T(()=>{const[i,o,l]=r();if(i<0)return e.fallback;const c=l.children;return typeof c=="function"&&c.length>0?_(()=>c(t?o:()=>{if(_(r)[0]!==i)throw ke("Match");return l.when})):c},void 0,void 0)}function M(e){return e}function De(e,t,n){let s=n.length,r=t.length,i=s,o=0,l=0,c=t[r-1].nextSibling,f=null;for(;o<r||l<i;){if(t[o]===n[l]){o++,l++;continue}for(;t[r-1]===n[i-1];)r--,i--;if(r===o){const a=i<s?l?n[l-1].nextSibling:n[i-l]:c;for(;l<i;)e.insertBefore(n[l++],a)}else if(i===l)for(;o<r;)(!f||!f.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[i-1]&&n[l]===t[r-1]){const a=t[--r].nextSibling;e.insertBefore(n[l++],t[o++].nextSibling),e.insertBefore(n[--i],a),t[r]=n[i]}else{if(!f){f=new Map;let g=l;for(;g<i;)f.set(n[g],g++)}const a=f.get(t[o]);if(a!=null)if(l<a&&a<i){let g=o,d=1,v;for(;++g<r&&g<i&&!((v=f.get(t[g]))==null||v!==a+d);)d++;if(d>a-l){const C=t[o];for(;l<a;)e.insertBefore(n[l++],C)}else e.replaceChild(n[l++],t[o++])}else o++;else t[o++].remove()}}}const fe="_$DX_DELEGATE";function Ze(e,t,n,s={}){let r;return G(i=>{r=i,t===document?e():P(t,e(),t.firstChild?null:void 0,n)},s.owner),()=>{r(),t.textContent=""}}function H(e,t,n){let s;const r=()=>{const o=document.createElement("template");return o.innerHTML=e,n?o.content.firstChild.firstChild:o.content.firstChild},i=t?()=>_(()=>document.importNode(s||(s=r()),!0)):()=>(s||(s=r())).cloneNode(!0);return i.cloneNode=i,i}function ae(e,t=window.document){const n=t[fe]||(t[fe]=new Set);for(let s=0,r=e.length;s<r;s++){const i=e[s];n.has(i)||(n.add(i),t.addEventListener(i,Ve))}}function je(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function ze(e,t,n){if(!t)return n?je(e,"style"):t;const s=e.style;if(typeof t=="string")return s.cssText=t;typeof n=="string"&&(s.cssText=n=void 0),n||(n={}),t||(t={});let r,i;for(i in n)t[i]==null&&s.removeProperty(i),delete n[i];for(i in t)r=t[i],r!==n[i]&&(s.setProperty(i,r),n[i]=r);return n}function ue(e,t,n){return _(()=>e(t,n))}function P(e,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return X(e,t,s,n);I(r=>X(e,t(),r,n),s)}function Ve(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n;){const s=n[t];if(s&&!n.disabled){const r=n[`${t}Data`];if(r!==void 0?s.call(n,r,e):s.call(n,e),e.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function X(e,t,n,s,r){for(;typeof n=="function";)n=n();if(t===n)return n;const i=typeof t,o=s!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,i==="string"||i==="number")if(i==="number"&&(t=t.toString()),o){let l=n[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),n=B(e,n,s,l)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||i==="boolean")n=B(e,n,s);else{if(i==="function")return I(()=>{let l=t();for(;typeof l=="function";)l=l();n=X(e,l,n,s)}),()=>n;if(Array.isArray(t)){const l=[],c=n&&Array.isArray(n);if(oe(l,t,n,r))return I(()=>n=X(e,l,n,s,!0)),()=>n;if(l.length===0){if(n=B(e,n,s),o)return n}else c?n.length===0?de(e,l,s):De(e,n,l):(n&&B(e),de(e,l));n=l}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=B(e,n,s,t);B(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}else console.warn("Unrecognized value. Skipped inserting",t)}return n}function oe(e,t,n,s){let r=!1;for(let i=0,o=t.length;i<o;i++){let l=t[i],c=n&&n[i],f;if(!(l==null||l===!0||l===!1))if((f=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))r=oe(e,l,c)||r;else if(f==="function")if(s){for(;typeof l=="function";)l=l();r=oe(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||r}else e.push(l),r=!0;else{const a=String(l);c&&c.nodeType===3&&c.data===a?e.push(c):e.push(document.createTextNode(a))}}return r}function de(e,t,n=null){for(let s=0,r=t.length;s<r;s++)e.insertBefore(t[s],n)}function B(e,t,n,s){if(n===void 0)return e.textContent="";const r=s||document.createTextNode("");if(t.length){let i=!1;for(let o=t.length-1;o>=0;o--){const l=t[o];if(r!==l){const c=l.parentNode===e;!i&&!o?c?e.replaceChild(r,l):e.insertBefore(r,n):c&&l.remove()}else i=!0}}else e.insertBefore(r,n);return[r]}function Je(e=4096){const t=new ArrayBuffer(e);return{i:0,view:new DataView(t),bytes:new Uint8Array(t)}}function Ge(e){e.bytes=new Uint8Array(e.bytes.length*2),e.view=new DataView(e.bytes.buffer)}function he(e,t,n){for(;;){const s=e.bytes.length-8;e.i=0;try{if(t(e,n),e.i<s)return e.bytes}catch(r){if(e.i<s&&!(r instanceof RangeError))throw r}Ge(e)}}function qe(e,t,n){const{length:s}=n;s<4096?(e.bytes.set(n),e.i=0):e=We(n);const r=t(e);if(e.i!==s)throw RangeError(`Expected to process ${s} bytes, processed ${e.i} bytes instead`);return r}function We(e){return{i:0,bytes:e,view:new DataView(e.buffer,e.byteOffset,e.byteLength)}}function U(e,t){return{ser:e,des:t}}function Qe({ser:e,des:t},n){const s=Je(n);return{ser:e,des:t,toBytes:r=>he(s,e,r).slice(0,s.i),toUnsafeBytes:r=>he(s,e,r).subarray(0,s.i),fromBytes:r=>qe(s,t,r)}}const Xe={encode(e,t){const{length:n}=t;for(let s=0;s<n;s++){const r=t.charCodeAt(s);if(r<128)e.view.setUint8(e.i,r),e.i++;else if(r<2048){const i=(r&1984)<<2,o=r&63;e.view.setUint16(e.i,i|o|49280),e.i+=2}else if(r<55296||r>=57344){const i=(r&61440)<<12,o=(r&4032)<<10,l=(r&63)<<8;e.view.setUint32(e.i,i|o|l|3766517760),e.i+=3}else{const i=t.codePointAt(s++),o=(i&1835008)<<6,l=(i&258048)<<4,c=(i&4032)<<2,f=i&63;e.view.setUint32(e.i,o|l|c|f|4034953344),e.i+=4}}},decode(e,t){const n=[],s=e.i+t;for(;e.i<s;){const r=e.view.getUint8(e.i);if(r<192)n.push(r),e.i++;else if(r<224){const i=e.view.getUint8(e.i+1);e.i+=2,n.push((r&31)<<6|i&63)}else if(r<240){const i=e.view.getUint8(e.i+1),o=e.view.getUint8(e.i+2);e.i+=3,n.push((r&15)<<12|(i&63)<<6|o&63)}else{const i=e.view.getUint32(e.i),o=(r&7)<<18,l=(i&4128768)>>4,c=(i&16128)>>2,f=i&63;n.push(o|l|c|f),e.i+=4}}return String.fromCodePoint(...n)}},Ye=(e,t)=>U((n,s)=>{const{length:r}=s;t.ser(n,r);for(let i=0;i<r;i++)e.ser(n,s[i])},n=>{const s=t.des(n),r=new Array(s);for(let i=0;i<s;i++)r[i]=e.des(n);return r}),D=e=>U((t,n)=>{const{byteLength:s}=n;e.ser(t,s);const{i:r}=t;t.i+=s,t.bytes.set(n,r)},t=>{const n=e.des(t);return t.bytes.subarray(t.i,t.i+=n)}),et=(e,t)=>U((n,s)=>{const r=n.i;t.ser(n,s.length);const i=n.i,o=i-r;e.encode(n,s);const l=n.i,c=l-i;if(c===s.length)return;t.ser(n,c);const f=n.i-l;o!==f&&n.bytes.copyWithin(r+f,i,l),n.i=r,t.ser(n,c),n.i=l+(f-o)},n=>e.decode(n,t.des(n)));class tt extends Error{constructor(t){super(`Invalid oneOf type (${t})`),this.type=t}}const nt=(e,t)=>{const n=Object.keys(t),s=rt(n),r=st(s);return U((i,o)=>{const l=s[o.type];e.ser(i,l),t[o.type].ser(i,o.value)},i=>{const o=e.des(i),l=r[o];if(l===void 0)throw new tt(o);const f=t[l].des(i);return{type:l,value:f}})};function rt(e){const t={};for(let n=0;n<e.length;++n){const s=e[n];t[s]=n}return t}function st(e){const t={};for(const n of Object.keys(e)){const s=e[n];t[s]=n}return t}const Ae=U((e,t)=>e.view.setUint8(e.i++,t),e=>e.view.getUint8(e.i++)),N=U((e,t)=>{e.view.setUint16(e.i,t),e.i+=2},e=>{const t=e.view.getUint16(e.i);return e.i+=2,t}),Z=U((e,t)=>{e.view.setUint32(e.i,t),e.i+=4},e=>{const t=e.view.getUint32(e.i);return e.i+=4,t}),J=e=>{const t=e instanceof Array?()=>[]:()=>({});return U((n,s)=>{for(const r in e)e[r].ser(n,s[r])},n=>{const s=t();for(const r in e)s[r]=e[r].des(n);return s})},it=J({publicKey:D(Z),signature:D(Z)}),ot=J({publicKey:D(Z),signature:D(Z)}),lt=Ye(J({index:N,name:et(Xe,N),size:Z}),N),at=J({index:N,progress:Ae}),ct=J({chunk:D(N)}),ft=nt(Ae,{Handshake:it,HandshakeResponse:ot,List:lt,Progress:at,Chunk:ct}),{fromBytes:ut,toUnsafeBytes:dt}=Qe(ft);function j(e,t){return{type:e,value:t}}function z(e){return dt(e)}function ne(e){return ut(e)}class ht{constructor(t,n,s,r,i,o,l){this.messageCallback=n,this.openCallback=s,this.createRoomCallback=r,this.leaveRoomCallback=i,this.joinRoomCallback=o,this.errorCallback=l,this.webSocket=new WebSocket(t),this.webSocket.onopen=this.onOpen.bind(this),this.webSocket.onclose=this.onClose.bind(this),this.webSocket.onerror=this.onError.bind(this),this.webSocket.onmessage=this.onMessage.bind(this)}ROOM_SIZE=2;IV_SIZE=12;DESTINATION=1;keyPair;HMACKey;sharedKey;webSocket;async init(){try{this.keyPair=await window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey"])}catch(t){return this.error("Failed to generate public-private key: "+t)}try{this.HMACKey=await window.crypto.subtle.generateKey({name:"HMAC",hash:{name:"SHA-256"}},!0,["sign","verify"])}catch(t){return this.error("Failed to generate HMAC key: "+t)}this.sendJSON({type:"create",size:this.ROOM_SIZE})}async onOpen(){this.openCallback()}async onClose(){return this.error("The connection to the network was closed.")}async onError(){return this.error("The connection to the network was closed due to an error.")}async onMessage(t){if(t.data instanceof Blob){const n=await t.data.arrayBuffer(),s=new Uint8Array(n).slice(1);if(this.sharedKey){const r=s.slice(0,this.IV_SIZE),i=s.slice(this.IV_SIZE);try{const o=new Uint8Array(await window.crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.sharedKey,i));return this.messageCallback(o)}catch(o){return this.error("Failed to decrypt: "+o)}}else{const r=ne(s);switch(r.type){case"HandshakeResponse":return this.onHandshakeResponse(r.value)}}}else{const n=JSON.parse(t.data);switch(n.type){case"create":return this.onCreateRoom(n.id);case"leave":return this.onLeaveRoom();case"join":return this.onJoinRoom();case"error":return this.error(n.message)}}}async onLeaveRoom(){this.sharedKey=void 0,this.leaveRoomCallback()}async onCreateRoom(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");let n;try{n=await window.crypto.subtle.exportKey("raw",this.HMACKey)}catch(r){return this.error("Failed to export HMAC key: "+r)}const s=t+"-"+btoa(String.fromCharCode(...new Uint8Array(n)));this.createRoomCallback(s)}async onJoinRoom(){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let t;try{t=new Uint8Array(await window.crypto.subtle.exportKey("raw",this.keyPair.publicKey))}catch(i){return this.error("Failed to export public key: "+i)}let n;try{n=new Uint8Array(await window.crypto.subtle.sign("HMAC",this.HMACKey,t))}catch(i){return this.error("Failed to export HMAC key: "+i)}const s=j("Handshake",{publicKey:t,signature:n}),r=z(s);this.send(r)}async onHandshakeResponse(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let n;try{n=await window.crypto.subtle.verify("HMAC",this.HMACKey,t.signature,t.publicKey)}catch(r){return this.error("Failed to verify public key: "+r)}if(!n)return this.error("The signature from the receiver was invalid.");let s;try{s=await window.crypto.subtle.importKey("raw",t.publicKey,{name:"ECDH",namedCurve:"P-256"},!1,[])}catch(r){return this.error("Failed to import public key: "+r)}try{this.sharedKey=await window.crypto.subtle.deriveKey({name:"ECDH",public:s},this.keyPair.privateKey,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])}catch(r){return this.error("Failed to derive key: "+r)}this.joinRoomCallback()}close(){this.webSocket.readyState===this.webSocket.OPEN&&this.sendJSON({type:"leave"})}error(t){this.close(),this.errorCallback(t)}async sendJSON(t){this.webSocket.send(JSON.stringify(t))}async send(t){const n=new Uint8Array([this.DESTINATION]);if(this.sharedKey){const s=window.crypto.getRandomValues(new Uint8Array(12));try{const r=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},this.sharedKey,t);this.webSocket.send(new Blob([n,s,r]))}catch(r){return this.error("Failed to encrypt: "+r)}}else this.webSocket.send(new Blob([n,t]))}}const yt=H('<button class="transition border w-fit font-bold border-[#4a4f58] py-2 px-6 rounded hover:bg-[#292e34] mr-2">Go Back'),pt=H('<button class="transition w-fit font-bold border-[#4a4f58] py-2 px-4 rounded hover:bg-[#292e34]">Retry'),wt=H('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><svg class="w-32 h-32 mb-[-20px]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 125.0125"><path fill="#ff3b3b" d="M50,14.57A35.44,35.44,0,1,0,85.43,50,35.47,35.47,0,0,0,50,14.57Zm-1.74,15.1a1.74,1.74,0,0,1,3.48,0V57.6a1.74,1.74,0,0,1-3.48,0ZM50,71a3.08,3.08,0,1,1,3.07-3.08A3.07,3.07,0,0,1,50,71Z"></path></svg><div class="text-4xl text-white">Error</div><div class="text-xl text-white max-w-lg mt-3 mb-5 text-center"></div><div class="flex flex-row">'),gt=H('<button class="transition border w-fit font-bold border-[#4a4f58] py-2 px-6 rounded hover:bg-[#292e34] mr-2">Retry'),Se=e=>{const t=()=>{location.reload()},n=()=>{history.pushState("",document.title,window.location.pathname+window.location.search),location.reload()};return(()=>{const s=wt(),r=s.firstChild,i=r.nextSibling,o=i.nextSibling,l=o.nextSibling;return P(o,()=>e.message),P(l,h(le,{get when(){return location.hash},get fallback(){return(()=>{const c=gt();return c.$$click=t,c})()},get children(){return[(()=>{const c=yt();return c.$$click=n,c})(),(()=>{const c=pt();return c.$$click=t,c})()]}})),s})()};ae(["click"]);const bt=H('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><div class="text-4xl max-w-lg mb-3">Your file(s) are ready to send...</div><div class="text-lg max-w-lg mb-6">Copy the link to share your file(s). Keep your <b>browser tab open</b> as data will be sent in real-time rather than being uploaded to a server.</div><input type="text" placeholder="Type a name..." readonly class="max-w-lg mb-4 focus:border-[#9ea6b5] border rounded bg-transparent border-[#4a4f58] w-full py-4 px-3 text-white leading-tight focus:outline-none"><button class="transition w-full max-w-lg font-bold bg-[#0060df] py-3 px-6 rounded hover:bg-[#2e75d1]">'),mt=()=>{const[e,t]=F(!1),n=()=>{navigator.clipboard.writeText(window.location.href),t(!0),setTimeout(()=>t(!1),1e3)};return(()=>{const s=bt(),r=s.firstChild,i=r.nextSibling,o=i.nextSibling,l=o.nextSibling;return l.$$click=n,P(l,h(le,{get when(){return e()},fallback:"Copy link",children:"Copied!"})),I(()=>o.value=window.location.href),s})()};ae(["click"]);const vt=H('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8"><svg class="w-16 h-16 text-[#0f1013] animate-spin mb-7 dark:text-gray-600 fill-[#fff]" viewBox="0 0 100 101" fill="none"><path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"></path><path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"></path></svg><div class="text-white text-xl max-w-lg select-none text-center">'),$e=e=>(()=>{const t=vt(),n=t.firstChild,s=n.nextSibling;return P(s,()=>e.message),t})(),Ct=H(`<div class="flex h-fit min-dvh-screen justify-center md:items-center items-start"><div class="flex flex-col-reverse dvh-screen md:h-fit md:flex-row max-w-[53rem] bg-[#23272c] shadow-lg rounded-md overflow-hidden text-center"><div class="flex flex-col items-center justify-center h-full border-2 border-dashed rounded-md border-[#64676e] px-[100px] py-[150px]"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-3" fill="#fff" viewBox="0 0 32 32"><path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 
                14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 
                0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path></svg><div class="text-2xl w-max">Drag and drop files</div><div class="text-l w-max mb-6">or click to select files</div><button class="transition w-fit font-bold bg-[#0060df] py-3 px-6 rounded hover:bg-[#2e75d1] mr-2">Select files to share</button><input multiple type="file"></div><div class="flex flex-col bg-[#101214] pb-7 w-full md:pb-0 md:w-[21rem]"><div class="flex flex-row m-7 mb-6 items-center"><div class="bg-[#0060df] h-14 w-14 p-1 rounded-lg mr-5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 45"><path fill="#fff" d="M18,2A16,16,0,1,0,34,18,16,16,0,0,0,18,2Zm9.57,18.18C24.45,21.85,18,24.89,14.5,26.57A3.6,3.6,0,0,1,13,26.9a3.45,3.45,0,
                  0,1-2-.63,3.78,3.78,0,0,1-1.6-3.13V21.43h2.29v1.71a1.52,1.52,0,0,0,.62,1.26,1.2,1.2,0,0,0,1.19.1c3.53-1.67,9.9-4.7,13-6.33a.21.21,0,
                  0,0,0-.32c-3.1-1.66-9.46-4.69-13-6.34a1.19,1.19,0,0,0-1.2.1,1.51,1.51,0,0,0-.62,1.26v2.74a1.13,1.13,0,0,0,1.05,1.25h2.38v2.29H12.77a3.41,
                  3.41,0,0,1-3.34-3.53V12.87A3.77,3.77,0,0,1,11,9.74a3.42,3.42,0,0,1,3.47-.29c3.53,1.66,9.93,4.71,13.06,6.38a2.48,2.48,0,0,1,0,
                  4.35Zm-10.14-1V16.86h2.29v2.29Z"></path></svg></div><div class="text-5xl font-bold mb-[5px] select-none text-white">Share</div></div><div class="mx-7 text-gray-300 text-justify">Share is a real-time, peer-to-peer file transfer platform with a focus on security. With Share, you can send files of any size, and you can have peace of mind knowing that your files will be sent using end-to-end encryption and will never be stored on any server.`),kt=e=>{const[t,n]=F(!1),s=a=>{const g=a.target;g.files&&g.files.length>0&&e.selectFiles(g.files)},r=a=>{a.preventDefault(),a.dataTransfer&&a.dataTransfer.files&&a.dataTransfer.files.length>0&&e.selectFiles(a.dataTransfer.files)},i=a=>{a.preventDefault(),n(!0)},o=a=>{a.target===f&&!f?.contains(a.fromElement)&&n(!1)},l=()=>{c?.click()};let c,f;return(()=>{const a=Ct(),g=a.firstChild,d=g.firstChild,v=d.firstChild,C=v.nextSibling,A=C.nextSibling,p=A.nextSibling,u=p.nextSibling;d.addEventListener("dragleave",o),d.addEventListener("dragover",i),d.addEventListener("drop",r);const y=f;typeof y=="function"?ue(y,d):f=d,p.$$click=l,u.addEventListener("change",s);const b=c;return typeof b=="function"?ue(b,u):c=u,u.style.setProperty("display","none"),I(S=>ze(d,t()?{"border-color":"whitesmoke"}:{},S)),a})()};ae(["click"]);const xt=H('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center p-8 text-center"><div class="text-4xl max-w-lg mb-3">Transferring files...</div><div class="text-lg max-w-lg mb-6 px-3">Keep your <b>browser tab open</b> as files are sent in real-time.</div><div class="flex flex-col gap-3 w-full items-center">'),At=H('<div class="flex flex-col bg-[#23272c] shadow-lg rounded-md text-left p-4 w-full max-w-[500px]"><div class="flex flex-row"><div class="mr-2"><svg class="w-12 h-12 invert" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="m79.46,22.56l-6.67-7.04-3.92-4.14c-.33-.35-.7-.62-1.1-.84-.23-.13-.48-.23-.73-.31-.07-.02-.13-.05-.2-.07h0s0,0,0,0v11.08c0,1.26.87,2.32,2.04,2.61.21.05.43.09.66.09h10.81s0,0,0,0h0c-.23-.51-.52-.99-.9-1.39Z"></path><path d="m27.79,10c-4.75,0-8.61,4.12-8.61,9.19v61.62c0,5.07,3.86,9.19,8.61,9.19h44.41c4.75,0,8.61-4.12,8.61-9.19V27.2h-11.26c-3.28,0-5.95-2.67-5.95-5.95v-11.25H27.79Zm4.58,17.57h17.62c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62h-17.62c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62Zm35.24,44.86h-35.24c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62h35.24c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62Zm0-24.05c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62h-35.24c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62h35.24Z"></path></svg></div><div class="flex flex-col items-start"><div class="font-bold"></div><div></div></div></div><div class="flex flex-col px-2"><div class="text-[#2f88fc] font-bold mb-1 mt-1">%</div><div class="w-full bg-gray-700 rounded-full h-1.5 mb-2"><div class="bg-[#2f88fc] h-1.5 rounded-full">'),Ee=e=>{const t=n=>{const s=n==0?0:Math.floor(Math.log(n)/Math.log(1024));return(n/Math.pow(1024,s)).toFixed(2)+" "+["B","KB","MB","GB","TB"][s]};return(()=>{const n=xt(),s=n.firstChild,r=s.nextSibling,i=r.nextSibling;return P(i,h(Ne,{get each(){return e.files()},children:o=>(()=>{const l=At(),c=l.firstChild,f=c.firstChild,a=f.nextSibling,g=a.firstChild,d=g.nextSibling,v=c.nextSibling,C=v.firstChild,A=C.firstChild,p=C.nextSibling,u=p.firstChild;return P(g,()=>o.name),P(d,()=>t(o.size)),P(C,()=>o.progress(),A),I(()=>o.progress()+"%"!=null?u.style.setProperty("width",o.progress()+"%"):u.style.removeProperty("width")),l})()})),n})()},St=H(`<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><svg class="w-28 h-28" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 125"><g transform="translate(0,-952.36218)"><path style="opacity:1;color:#000000;fill:#3bff55;stroke:none;stroke-width:7.09253644999999990;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" d="M 50 8 C 26.80404 8 8 26.80404 8 50 C 8 73.19596 26.80404 92 50 92 C 73.19596 92 92 73.19596 92 50 C 92 26.80404 73.19596 8 50 8 z M 71.1875 32.96875 A 
          2.0001995 2.0001995 0 0 1 72.6875 36.375 L 45.4375 64.375 A 2.0001995 2.0001995 0 0 1 42.5625 64.375 L 29.8125 51.28125 A 2.0001995 2.0001995 0 1 1 32.6875 
          48.5 L 44 60.125 L 69.8125 33.59375 A 2.0001995 2.0001995 0 0 1 71.1875 32.96875 z " transform="translate(0,952.36218)"></path></g></svg><div class="text-4xl text-white">Transfer Completed</div><div class="text-xl text-white max-w-lg mt-3 mb-5 text-center">The file transfer was completed successfully.`),Ke=()=>St(),$t=()=>{let t,n,s,r;const[i,o]=F([]),[l,c]=F({type:"loading",message:"Attempting to connect..."}),f=w=>{const $=ne(w);switch($.type){case"Progress":return A($.value)}},a=()=>{c({type:"selectFile"})},g=w=>{location.hash=w,c({type:"invite"})},d=()=>{for(const w of i())w.setProgress(0);l().type==="transferFile"&&c({type:"invite"})},v=async()=>{c({type:"transferFile"}),await S(),await b()},C=w=>{c({type:"error",message:w})},A=w=>{const $=i().at(w.index);if(!$)return R.error("Expected valid progress packet index.");w.progress===100&&w.index===i().length-1&&c({type:"transferFileCompleted"}),$.setProgress(w.progress)},p=w=>{if(l().type!=="selectFile")return;if(w.length===0)return R.error("Expected file list to not be empty.");const $=[];for(let K=0;K<w.length;K++){const re=w[K],[Me,_e]=F(0);$.push({index:K,file:re,progress:Me,setProgress:_e,name:re.name,size:re.size})}o($),c({type:"loading",message:"Attempting to create room..."}),R.init()},u=()=>{const w=new Uint8Array(E.result),$=j("Chunk",{chunk:w}),K=z($);R.send(K),y()},y=()=>{if(l().type!=="transferFile")return;if(s===0){if(t===i().length-1)return;t++,n=0,r=65535,s=i()[t].size}const w=i()[t].file;if(!w)return R.error("File handle is invalid.");s<r&&(r=s);const $=w.slice(n,n+r);s-=r,n+=r,E.readAsArrayBuffer($)},b=()=>{t=0,n=0,r=65535,s=i()[t].size,y()},S=()=>{const w=j("List",[]);for(const K of i())w.value.push({index:K.index,name:K.name,size:K.size});const $=z(w);R.send($)},E=new FileReader;E.onload=u;const R=new ht("wss://vldr.org:8080/relay",f,a,g,d,v,C);return h(xe,{get children(){return[h(M,{get when(){return l().type==="error"},get children(){return h(Se,{get message(){return l().message}})}}),h(M,{get when(){return l().type==="loading"},get children(){return h($e,{get message(){return l().message}})}}),h(M,{get when(){return l().type==="invite"},get children(){return h(mt,{})}}),h(M,{get when(){return l().type==="selectFile"},get children(){return h(kt,{selectFiles:p})}}),h(M,{get when(){return l().type==="transferFile"},get children(){return h(Ee,{files:i})}}),h(M,{get when(){return l().type==="transferFileCompleted"},get children(){return h(Ke,{})}})]}})};class Et{constructor(t,n,s,r,i){this.inviteCode=n,this.messageCallback=s,this.errorCallback=r,this.leaveRoomCallback=i,this.webSocket=new WebSocket(t),this.webSocket.onopen=this.onOpen.bind(this),this.webSocket.onclose=this.onClose.bind(this),this.webSocket.onerror=this.onError.bind(this),this.webSocket.onmessage=this.onMessage.bind(this)}IV_SIZE=12;DESTINATION=0;keyPair;HMACKey;sharedKey;webSocket;async init(){if(!this.inviteCode)return this.error("Invite code is invalid.");const t=this.inviteCode.lastIndexOf("-");if(t===-1)return this.error("Invalid URL structure.");const n=this.inviteCode.slice(0,t),s=this.inviteCode.slice(t+1);if(!s||!n)return this.error("Invalid URL components.");let r;try{r=Uint8Array.from(atob(s),i=>i.charCodeAt(0))}catch(i){return this.error("Failed to decode key data: "+i)}try{this.HMACKey=await window.crypto.subtle.importKey("raw",r,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign","verify"])}catch(i){return this.error("Failed to import HMAC key: "+i)}try{this.keyPair=await window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey"])}catch(i){return this.error("Failed to generate public-private key: "+i)}this.sendJSON({type:"join",id:n})}async onOpen(){await this.init()}async onClose(){return this.error("The connection to the network was closed.")}async onError(){return this.error("The connection to the network was closed due to an error.")}async onMessage(t){if(t.data instanceof Blob){const n=await t.data.arrayBuffer(),s=new Uint8Array(n).slice(1);if(this.sharedKey){const r=s.slice(0,this.IV_SIZE),i=s.slice(this.IV_SIZE);try{const o=new Uint8Array(await window.crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.sharedKey,i));return this.messageCallback(o)}catch(o){return this.error("Failed to decrypt: "+o)}}else{const r=ne(s);switch(r.type){case"Handshake":return this.onHandshake(r.value)}}}else{const n=JSON.parse(t.data);switch(n.type){case"leave":return this.onLeaveRoom();case"error":return this.error(n.message)}}}async onLeaveRoom(){this.close(),this.leaveRoomCallback()}async onHandshake(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let n;try{n=await window.crypto.subtle.verify("HMAC",this.HMACKey,t.signature,t.publicKey)}catch(r){return this.error("Failed to verify public key: "+r)}if(!n)return this.error("The signature from the sender was invalid.");let s;try{s=await window.crypto.subtle.importKey("raw",t.publicKey,{name:"ECDH",namedCurve:"P-256"},!1,[])}catch(r){return this.error("Failed to import public key: "+r)}await this.sendHandshakeResponse();try{this.sharedKey=await window.crypto.subtle.deriveKey({name:"ECDH",public:s},this.keyPair.privateKey,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])}catch(r){return this.error("Failed to derive key: "+r)}}close(){this.webSocket.readyState===this.webSocket.OPEN&&this.sendJSON({type:"leave"})}error(t){this.close(),this.errorCallback(t)}async sendHandshakeResponse(){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let t;try{t=new Uint8Array(await window.crypto.subtle.exportKey("raw",this.keyPair.publicKey))}catch(i){return this.error("Failed to export public key: "+i)}let n;try{n=new Uint8Array(await window.crypto.subtle.sign("HMAC",this.HMACKey,t))}catch(i){return this.error("Failed to export HMAC key: "+i)}const s=j("HandshakeResponse",{publicKey:t,signature:n}),r=z(s);this.send(r)}async sendJSON(t){this.webSocket.send(JSON.stringify(t))}async send(t){const n=new Uint8Array([this.DESTINATION]);if(this.sharedKey){const s=window.crypto.getRandomValues(new Uint8Array(12));try{const r=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},this.sharedKey,t);this.webSocket.send(new Blob([n,s,r]))}catch(r){return this.error("Failed to encrypt: "+r)}}else this.webSocket.send(new Blob([n,t]))}}const Kt=()=>{let e,t,n,s;const[r,i]=F([]),[o,l]=F({type:"loading",message:"Attempting to connect..."}),c=p=>{const u=ne(p);switch(u.type){case"List":return g(u.value);case"Chunk":return d(u.value)}},f=p=>{l({type:"error",message:p})},a=()=>{if(o().type!=="transferFileCompleted")return A.error("File transfer was interrupted because the sender left.")},g=p=>{const u=[];for(const y of p){const[b,S]=F(0);u.push({name:y.name,index:y.index,size:y.size,progress:b,setProgress:S,file:void 0})}e=0,t=0,n=0,s=[],i(u),l({type:"transferFile"})},d=p=>{const u=r()[e];if(!u)return A.error("Chunk packet does not match a given index.");s.push(p.chunk),t+=p.chunk.byteLength,u.setProgress(t/u.size*100>>0),(u.progress()===100||u.progress()-n>1)&&C(u),u.size===t&&v(u)},v=p=>{const u=new Blob(s),y=document.createElement("a");document.body.appendChild(y);const b=window.URL.createObjectURL(u);y.href=b,y.download=p.name,y.click(),window.URL.revokeObjectURL(b),e++,t=0,n=0,s=[],e===r().length&&l({type:"transferFileCompleted"})},C=p=>{n=p.progress();const u=j("Progress",{index:p.index,progress:n}),y=z(u);A.send(y)},A=new Et("wss://vldr.org:8080/relay",location.hash.replace("#",""),c,f,a);return h(xe,{get children(){return[h(M,{get when(){return o().type==="error"},get children(){return h(Se,{get message(){return o().message}})}}),h(M,{get when(){return o().type==="loading"},get children(){return h($e,{get message(){return o().message}})}}),h(M,{get when(){return o().type==="transferFile"},get children(){return h(Ee,{files:r})}}),h(M,{get when(){return o().type==="transferFileCompleted"},get children(){return h(Ke,{})}})]}})},Mt=()=>h(le,{get when(){return location.hash},get fallback(){return h($t,{})},get children(){return h(Kt,{})}});const _t=document.getElementById("root");Ze(()=>h(Mt,{}),_t);
