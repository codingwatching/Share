(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const equalFn=(r,t)=>r===t,$TRACK=Symbol("solid-track"),signalOptions={equals:equalFn};let runEffects=runQueue;const STALE=1,PENDING=2,UNOWNED={owned:null,cleanups:null,context:null,owner:null};var Owner=null;let Transition=null,Listener=null,Updates=null,Effects=null,ExecCount=0;function createRoot(r,t){const e=Listener,n=Owner,i=r.length===0,o=i?UNOWNED:{owned:null,cleanups:null,context:null,owner:t===void 0?n:t},s=i?r:()=>r(()=>untrack(()=>cleanNode(o)));Owner=o,Listener=null;try{return runUpdates(s,!0)}finally{Listener=e,Owner=n}}function createSignal(r,t){t=t?Object.assign({},signalOptions,t):signalOptions;const e={value:r,observers:null,observerSlots:null,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(e.value)),writeSignal(e,i));return[readSignal.bind(e),n]}function createRenderEffect(r,t,e){const n=createComputation(r,t,!1,STALE);updateComputation(n)}function createMemo(r,t,e){e=e?Object.assign({},signalOptions,e):signalOptions;const n=createComputation(r,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=e.equals||void 0,updateComputation(n),readSignal.bind(n)}function untrack(r){if(Listener===null)return r();const t=Listener;Listener=null;try{return r()}finally{Listener=t}}function onCleanup(r){return Owner===null||(Owner.cleanups===null?Owner.cleanups=[r]:Owner.cleanups.push(r)),r}function children(r){const t=createMemo(r),e=createMemo(()=>resolveChildren(t()));return e.toArray=()=>{const n=e();return Array.isArray(n)?n:n!=null?[n]:[]},e}function readSignal(){if(this.sources&&this.state)if(this.state===STALE)updateComputation(this);else{const r=Updates;Updates=null,runUpdates(()=>lookUpstream(this),!1),Updates=r}if(Listener){const r=this.observers?this.observers.length:0;Listener.sources?(Listener.sources.push(this),Listener.sourceSlots.push(r)):(Listener.sources=[this],Listener.sourceSlots=[r]),this.observers?(this.observers.push(Listener),this.observerSlots.push(Listener.sources.length-1)):(this.observers=[Listener],this.observerSlots=[Listener.sources.length-1])}return this.value}function writeSignal(r,t,e){let n=r.value;return(!r.comparator||!r.comparator(n,t))&&(r.value=t,r.observers&&r.observers.length&&runUpdates(()=>{for(let i=0;i<r.observers.length;i+=1){const o=r.observers[i],s=Transition&&Transition.running;s&&Transition.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?Updates.push(o):Effects.push(o),o.observers&&markDownstream(o)),s||(o.state=STALE)}if(Updates.length>1e6)throw Updates=[],new Error},!1)),t}function updateComputation(r){if(!r.fn)return;cleanNode(r);const t=Owner,e=Listener,n=ExecCount;Listener=Owner=r,runComputation(r,r.value,n),Listener=e,Owner=t}function runComputation(r,t,e){let n;try{n=r.fn(t)}catch(i){return r.pure&&(r.state=STALE,r.owned&&r.owned.forEach(cleanNode),r.owned=null),r.updatedAt=e+1,handleError(i)}(!r.updatedAt||r.updatedAt<=e)&&(r.updatedAt!=null&&"observers"in r?writeSignal(r,n):r.value=n,r.updatedAt=e)}function createComputation(r,t,e,n=STALE,i){const o={fn:r,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Owner,context:null,pure:e};return Owner===null||Owner!==UNOWNED&&(Owner.owned?Owner.owned.push(o):Owner.owned=[o]),o}function runTop(r){if(r.state===0)return;if(r.state===PENDING)return lookUpstream(r);if(r.suspense&&untrack(r.suspense.inFallback))return r.suspense.effects.push(r);const t=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<ExecCount);)r.state&&t.push(r);for(let e=t.length-1;e>=0;e--)if(r=t[e],r.state===STALE)updateComputation(r);else if(r.state===PENDING){const n=Updates;Updates=null,runUpdates(()=>lookUpstream(r,t[0]),!1),Updates=n}}function runUpdates(r,t){if(Updates)return r();let e=!1;t||(Updates=[]),Effects?e=!0:Effects=[],ExecCount++;try{const n=r();return completeUpdates(e),n}catch(n){e||(Effects=null),Updates=null,handleError(n)}}function completeUpdates(r){if(Updates&&(runQueue(Updates),Updates=null),r)return;const t=Effects;Effects=null,t.length&&runUpdates(()=>runEffects(t),!1)}function runQueue(r){for(let t=0;t<r.length;t++)runTop(r[t])}function lookUpstream(r,t){r.state=0;for(let e=0;e<r.sources.length;e+=1){const n=r.sources[e];if(n.sources){const i=n.state;i===STALE?n!==t&&(!n.updatedAt||n.updatedAt<ExecCount)&&runTop(n):i===PENDING&&lookUpstream(n,t)}}}function markDownstream(r){for(let t=0;t<r.observers.length;t+=1){const e=r.observers[t];e.state||(e.state=PENDING,e.pure?Updates.push(e):Effects.push(e),e.observers&&markDownstream(e))}}function cleanNode(r){let t;if(r.sources)for(;r.sources.length;){const e=r.sources.pop(),n=r.sourceSlots.pop(),i=e.observers;if(i&&i.length){const o=i.pop(),s=e.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,e.observerSlots[n]=s)}}if(r.owned){for(t=r.owned.length-1;t>=0;t--)cleanNode(r.owned[t]);r.owned=null}if(r.cleanups){for(t=r.cleanups.length-1;t>=0;t--)r.cleanups[t]();r.cleanups=null}r.state=0,r.context=null}function castError(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function handleError(r,t=Owner){throw castError(r)}function resolveChildren(r){if(typeof r=="function"&&!r.length)return resolveChildren(r());if(Array.isArray(r)){const t=[];for(let e=0;e<r.length;e++){const n=resolveChildren(r[e]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return r}const FALLBACK=Symbol("fallback");function dispose(r){for(let t=0;t<r.length;t++)r[t]()}function mapArray(r,t,e={}){let n=[],i=[],o=[],s=0,l=t.length>1?[]:null;return onCleanup(()=>dispose(o)),()=>{let a=r()||[],c,u;return a[$TRACK],untrack(()=>{let f=a.length,w,d,p,y,b,m,$,k,g;if(f===0)s!==0&&(dispose(o),o=[],n=[],i=[],s=0,l&&(l=[])),e.fallback&&(n=[FALLBACK],i[0]=createRoot(v=>(o[0]=v,e.fallback())),s=1);else if(s===0){for(i=new Array(f),u=0;u<f;u++)n[u]=a[u],i[u]=createRoot(h);s=f}else{for(p=new Array(f),y=new Array(f),l&&(b=new Array(f)),m=0,$=Math.min(s,f);m<$&&n[m]===a[m];m++);for($=s-1,k=f-1;$>=m&&k>=m&&n[$]===a[k];$--,k--)p[k]=i[$],y[k]=o[$],l&&(b[k]=l[$]);for(w=new Map,d=new Array(k+1),u=k;u>=m;u--)g=a[u],c=w.get(g),d[u]=c===void 0?-1:c,w.set(g,u);for(c=m;c<=$;c++)g=n[c],u=w.get(g),u!==void 0&&u!==-1?(p[u]=i[c],y[u]=o[c],l&&(b[u]=l[c]),u=d[u],w.set(g,u)):o[c]();for(u=m;u<f;u++)u in p?(i[u]=p[u],o[u]=y[u],l&&(l[u]=b[u],l[u](u))):i[u]=createRoot(h);i=i.slice(0,s=f),n=a.slice(0)}return i});function h(f){if(o[u]=f,l){const[w,d]=createSignal(u);return l[u]=d,t(a[u],w)}return t(a[u])}}}function createComponent(r,t){return untrack(()=>r(t||{}))}const narrowedError=r=>`Stale read from <${r}>.`;function For(r){const t="fallback"in r&&{fallback:()=>r.fallback};return createMemo(mapArray(()=>r.each,r.children,t||void 0))}function Show(r){const t=r.keyed,e=createMemo(()=>r.when,void 0,{equals:(n,i)=>t?n===i:!n==!i});return createMemo(()=>{const n=e();if(n){const i=r.children;return typeof i=="function"&&i.length>0?untrack(()=>i(t?n:()=>{if(!untrack(e))throw narrowedError("Show");return r.when})):i}return r.fallback},void 0,void 0)}function Switch(r){let t=!1;const e=(o,s)=>o[0]===s[0]&&(t?o[1]===s[1]:!o[1]==!s[1])&&o[2]===s[2],n=children(()=>r.children),i=createMemo(()=>{let o=n();Array.isArray(o)||(o=[o]);for(let s=0;s<o.length;s++){const l=o[s].when;if(l)return t=!!o[s].keyed,[s,l,o[s]]}return[-1]},void 0,{equals:e});return createMemo(()=>{const[o,s,l]=i();if(o<0)return r.fallback;const a=l.children;return typeof a=="function"&&a.length>0?untrack(()=>a(t?s:()=>{if(untrack(i)[0]!==o)throw narrowedError("Match");return l.when})):a},void 0,void 0)}function Match(r){return r}function reconcileArrays(r,t,e){let n=e.length,i=t.length,o=n,s=0,l=0,a=t[i-1].nextSibling,c=null;for(;s<i||l<o;){if(t[s]===e[l]){s++,l++;continue}for(;t[i-1]===e[o-1];)i--,o--;if(i===s){const u=o<n?l?e[l-1].nextSibling:e[o-l]:a;for(;l<o;)r.insertBefore(e[l++],u)}else if(o===l)for(;s<i;)(!c||!c.has(t[s]))&&t[s].remove(),s++;else if(t[s]===e[o-1]&&e[l]===t[i-1]){const u=t[--i].nextSibling;r.insertBefore(e[l++],t[s++].nextSibling),r.insertBefore(e[--o],u),t[i]=e[o]}else{if(!c){c=new Map;let h=l;for(;h<o;)c.set(e[h],h++)}const u=c.get(t[s]);if(u!=null)if(l<u&&u<o){let h=s,f=1,w;for(;++h<i&&h<o&&!((w=c.get(t[h]))==null||w!==u+f);)f++;if(f>u-l){const d=t[s];for(;l<u;)r.insertBefore(e[l++],d)}else r.replaceChild(e[l++],t[s++])}else s++;else t[s++].remove()}}}const $$EVENTS="_$DX_DELEGATE";function render(r,t,e,n={}){let i;return createRoot(o=>{i=o,t===document?r():insert(t,r(),t.firstChild?null:void 0,e)},n.owner),()=>{i(),t.textContent=""}}function template(r,t,e){let n;const i=()=>{const s=document.createElement("template");return s.innerHTML=r,e?s.content.firstChild.firstChild:s.content.firstChild},o=t?()=>untrack(()=>document.importNode(n||(n=i()),!0)):()=>(n||(n=i())).cloneNode(!0);return o.cloneNode=o,o}function delegateEvents(r,t=window.document){const e=t[$$EVENTS]||(t[$$EVENTS]=new Set);for(let n=0,i=r.length;n<i;n++){const o=r[n];e.has(o)||(e.add(o),t.addEventListener(o,eventHandler))}}function setAttribute(r,t,e){e==null?r.removeAttribute(t):r.setAttribute(t,e)}function style(r,t,e){if(!t)return e?setAttribute(r,"style"):t;const n=r.style;if(typeof t=="string")return n.cssText=t;typeof e=="string"&&(n.cssText=e=void 0),e||(e={}),t||(t={});let i,o;for(o in e)t[o]==null&&n.removeProperty(o),delete e[o];for(o in t)i=t[o],i!==e[o]&&(n.setProperty(o,i),e[o]=i);return e}function use(r,t,e){return untrack(()=>r(t,e))}function insert(r,t,e,n){if(e!==void 0&&!n&&(n=[]),typeof t!="function")return insertExpression(r,t,n,e);createRenderEffect(i=>insertExpression(r,t(),i,e),n)}function eventHandler(r){const t=`$$${r.type}`;let e=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==e&&Object.defineProperty(r,"target",{configurable:!0,value:e}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}});e;){const n=e[t];if(n&&!e.disabled){const i=e[`${t}Data`];if(i!==void 0?n.call(e,i,r):n.call(e,r),r.cancelBubble)return}e=e._$host||e.parentNode||e.host}}function insertExpression(r,t,e,n,i){for(;typeof e=="function";)e=e();if(t===e)return e;const o=typeof t,s=n!==void 0;if(r=s&&e[0]&&e[0].parentNode||r,o==="string"||o==="number")if(o==="number"&&(t=t.toString()),s){let l=e[0];l&&l.nodeType===3?l.data=t:l=document.createTextNode(t),e=cleanChildren(r,e,n,l)}else e!==""&&typeof e=="string"?e=r.firstChild.data=t:e=r.textContent=t;else if(t==null||o==="boolean")e=cleanChildren(r,e,n);else{if(o==="function")return createRenderEffect(()=>{let l=t();for(;typeof l=="function";)l=l();e=insertExpression(r,l,e,n)}),()=>e;if(Array.isArray(t)){const l=[],a=e&&Array.isArray(e);if(normalizeIncomingArray(l,t,e,i))return createRenderEffect(()=>e=insertExpression(r,l,e,n,!0)),()=>e;if(l.length===0){if(e=cleanChildren(r,e,n),s)return e}else a?e.length===0?appendNodes(r,l,n):reconcileArrays(r,e,l):(e&&cleanChildren(r),appendNodes(r,l));e=l}else if(t.nodeType){if(Array.isArray(e)){if(s)return e=cleanChildren(r,e,n,t);cleanChildren(r,e,null,t)}else e==null||e===""||!r.firstChild?r.appendChild(t):r.replaceChild(t,r.firstChild);e=t}else console.warn("Unrecognized value. Skipped inserting",t)}return e}function normalizeIncomingArray(r,t,e,n){let i=!1;for(let o=0,s=t.length;o<s;o++){let l=t[o],a=e&&e[o],c;if(!(l==null||l===!0||l===!1))if((c=typeof l)=="object"&&l.nodeType)r.push(l);else if(Array.isArray(l))i=normalizeIncomingArray(r,l,a)||i;else if(c==="function")if(n){for(;typeof l=="function";)l=l();i=normalizeIncomingArray(r,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||i}else r.push(l),i=!0;else{const u=String(l);a&&a.nodeType===3&&a.data===u?r.push(a):r.push(document.createTextNode(u))}}return i}function appendNodes(r,t,e=null){for(let n=0,i=t.length;n<i;n++)r.insertBefore(t[n],e)}function cleanChildren(r,t,e,n){if(e===void 0)return r.textContent="";const i=n||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const l=t[s];if(i!==l){const a=l.parentNode===r;!o&&!s?a?r.replaceChild(i,l):r.insertBefore(i,e):a&&l.remove()}else o=!0}}else r.insertBefore(i,e);return[i]}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{},indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(r,t){for(var e=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)e[n++]=arguments[i++];return new Promise(function(l,a){e[n]=function(u){if(o)if(o=!1,u)a(u);else{for(var h=new Array(arguments.length-1),f=0;f<h.length;)h[f++]=arguments[f];l.apply(null,h)}};try{r.apply(t||null,e)}catch(c){o&&(o=!1,a(c))}})}var base64$1={};(function(r){var t=r;t.length=function(l){var a=l.length;if(!a)return 0;for(var c=0;--a%4>1&&l.charAt(a)==="=";)++c;return Math.ceil(l.length*3)/4-c};for(var e=new Array(64),n=new Array(123),i=0;i<64;)n[e[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(l,a,c){for(var u=null,h=[],f=0,w=0,d;a<c;){var p=l[a++];switch(w){case 0:h[f++]=e[p>>2],d=(p&3)<<4,w=1;break;case 1:h[f++]=e[d|p>>4],d=(p&15)<<2,w=2;break;case 2:h[f++]=e[d|p>>6],h[f++]=e[p&63],w=0;break}f>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,h)),f=0)}return w&&(h[f++]=e[d],h[f++]=61,w===1&&(h[f++]=61)),u?(f&&u.push(String.fromCharCode.apply(String,h.slice(0,f))),u.join("")):String.fromCharCode.apply(String,h.slice(0,f))};var o="invalid encoding";t.decode=function(l,a,c){for(var u=c,h=0,f,w=0;w<l.length;){var d=l.charCodeAt(w++);if(d===61&&h>1)break;if((d=n[d])===void 0)throw Error(o);switch(h){case 0:f=d,h=1;break;case 1:a[c++]=f<<2|(d&48)>>4,f=d,h=2;break;case 2:a[c++]=(f&15)<<4|(d&60)>>2,f=d,h=3;break;case 3:a[c++]=(f&3)<<6|d,h=0;break}}if(h===1)throw Error(o);return c-u},t.test=function(l){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(l)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this};EventEmitter.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this};EventEmitter.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this};var float=factory(factory);function factory(r){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),n=e[3]===128;function i(a,c,u){t[0]=a,c[u]=e[0],c[u+1]=e[1],c[u+2]=e[2],c[u+3]=e[3]}function o(a,c,u){t[0]=a,c[u]=e[3],c[u+1]=e[2],c[u+2]=e[1],c[u+3]=e[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(a,c){return e[0]=a[c],e[1]=a[c+1],e[2]=a[c+2],e[3]=a[c+3],t[0]}function l(a,c){return e[3]=a[c],e[2]=a[c+1],e[1]=a[c+2],e[0]=a[c+3],t[0]}r.readFloatLE=n?s:l,r.readFloatBE=n?l:s}():function(){function t(n,i,o,s){var l=i<0?1:0;if(l&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((l<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((l<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var a=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-a)*8388608)&8388607;n((l<<31|a+127<<23|c)>>>0,o,s)}}r.writeFloatLE=t.bind(null,writeUintLE),r.writeFloatBE=t.bind(null,writeUintBE);function e(n,i,o){var s=n(i,o),l=(s>>31)*2+1,a=s>>>23&255,c=s&8388607;return a===255?c?NaN:l*(1/0):a===0?l*1401298464324817e-60*c:l*Math.pow(2,a-150)*(c+8388608)}r.readFloatLE=e.bind(null,readUintLE),r.readFloatBE=e.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),n=e[7]===128;function i(a,c,u){t[0]=a,c[u]=e[0],c[u+1]=e[1],c[u+2]=e[2],c[u+3]=e[3],c[u+4]=e[4],c[u+5]=e[5],c[u+6]=e[6],c[u+7]=e[7]}function o(a,c,u){t[0]=a,c[u]=e[7],c[u+1]=e[6],c[u+2]=e[5],c[u+3]=e[4],c[u+4]=e[3],c[u+5]=e[2],c[u+6]=e[1],c[u+7]=e[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(a,c){return e[0]=a[c],e[1]=a[c+1],e[2]=a[c+2],e[3]=a[c+3],e[4]=a[c+4],e[5]=a[c+5],e[6]=a[c+6],e[7]=a[c+7],t[0]}function l(a,c){return e[7]=a[c],e[6]=a[c+1],e[5]=a[c+2],e[4]=a[c+3],e[3]=a[c+4],e[2]=a[c+5],e[1]=a[c+6],e[0]=a[c+7],t[0]}r.readDoubleLE=n?s:l,r.readDoubleBE=n?l:s}():function(){function t(n,i,o,s,l,a){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,l,a+i),n(1/s>0?0:2147483648,l,a+o);else if(isNaN(s))n(0,l,a+i),n(2146959360,l,a+o);else if(s>17976931348623157e292)n(0,l,a+i),n((c<<31|2146435072)>>>0,l,a+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,l,a+i),n((c<<31|u/4294967296)>>>0,l,a+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,l,a+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,l,a+o)}}}r.writeDoubleLE=t.bind(null,writeUintLE,0,4),r.writeDoubleBE=t.bind(null,writeUintBE,4,0);function e(n,i,o,s,l){var a=n(s,l+i),c=n(s,l+o),u=(c>>31)*2+1,h=c>>>20&2047,f=4294967296*(c&1048575)+a;return h===2047?f?NaN:u*(1/0):h===0?u*5e-324*f:u*Math.pow(2,h-1075)*(f+4503599627370496)}r.readDoubleLE=e.bind(null,readUintLE,0,4),r.readDoubleBE=e.bind(null,readUintBE,4,0)}(),r}function writeUintLE(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function writeUintBE(r,t,e){t[e]=r>>>24,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=r&255}function readUintLE(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0}function readUintBE(r,t){return(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}var utf8$2={};(function(r){var t=r;t.length=function(n){for(var i=0,o=0,s=0;s<n.length;++s)o=n.charCodeAt(s),o<128?i+=1:o<2048?i+=2:(o&64512)===55296&&(n.charCodeAt(s+1)&64512)===56320?(++s,i+=4):i+=3;return i},t.read=function(n,i,o){var s=o-i;if(s<1)return"";for(var l=null,a=[],c=0,u;i<o;)u=n[i++],u<128?a[c++]=u:u>191&&u<224?a[c++]=(u&31)<<6|n[i++]&63:u>239&&u<365?(u=((u&7)<<18|(n[i++]&63)<<12|(n[i++]&63)<<6|n[i++]&63)-65536,a[c++]=55296+(u>>10),a[c++]=56320+(u&1023)):a[c++]=(u&15)<<12|(n[i++]&63)<<6|n[i++]&63,c>8191&&((l||(l=[])).push(String.fromCharCode.apply(String,a)),c=0);return l?(c&&l.push(String.fromCharCode.apply(String,a.slice(0,c))),l.join("")):String.fromCharCode.apply(String,a.slice(0,c))},t.write=function(n,i,o){for(var s=o,l,a,c=0;c<n.length;++c)l=n.charCodeAt(c),l<128?i[o++]=l:l<2048?(i[o++]=l>>6|192,i[o++]=l&63|128):(l&64512)===55296&&((a=n.charCodeAt(c+1))&64512)===56320?(l=65536+((l&1023)<<10)+(a&1023),++c,i[o++]=l>>18|240,i[o++]=l>>12&63|128,i[o++]=l>>6&63|128,i[o++]=l&63|128):(i[o++]=l>>12|224,i[o++]=l>>6&63|128,i[o++]=l&63|128);return o-s}})(utf8$2);var pool_1=pool;function pool(r,t,e){var n=e||8192,i=n>>>1,o=null,s=n;return function(a){if(a<1||a>i)return r(a);s+a>n&&(o=r(n),s=0);var c=t.call(o,s,s+=a);return s&7&&(s=(s|7)+1),c}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var r=requireMinimal();function t(o,s){this.lo=o>>>0,this.hi=s>>>0}var e=t.zero=new t(0,0);e.toNumber=function(){return 0},e.zzEncode=e.zzDecode=function(){return this},e.length=function(){return 1};var n=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(s){if(s===0)return e;var l=s<0;l&&(s=-s);var a=s>>>0,c=(s-a)/4294967296>>>0;return l&&(c=~c>>>0,a=~a>>>0,++a>4294967295&&(a=0,++c>4294967295&&(c=0))),new t(a,c)},t.from=function(s){if(typeof s=="number")return t.fromNumber(s);if(r.isString(s))if(r.Long)s=r.Long.fromString(s);else return t.fromNumber(parseInt(s,10));return s.low||s.high?new t(s.low>>>0,s.high>>>0):e},t.prototype.toNumber=function(s){if(!s&&this.hi>>>31){var l=~this.lo+1>>>0,a=~this.hi>>>0;return l||(a=a+1>>>0),-(l+a*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(s){return r.Long?new r.Long(this.lo|0,this.hi|0,!!s):{low:this.lo|0,high:this.hi|0,unsigned:!!s}};var i=String.prototype.charCodeAt;return t.fromHash=function(s){return s===n?e:new t((i.call(s,0)|i.call(s,1)<<8|i.call(s,2)<<16|i.call(s,3)<<24)>>>0,(i.call(s,4)|i.call(s,5)<<8|i.call(s,6)<<16|i.call(s,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},t.prototype.zzDecode=function(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},t.prototype.length=function(){var s=this.lo,l=(this.lo>>>28|this.hi<<4)>>>0,a=this.hi>>>24;return a===0?l===0?s<16384?s<128?1:2:s<2097152?3:4:l<16384?l<128?5:6:l<2097152?7:8:a<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(r){var t=r;t.asPromise=aspromise,t.base64=base64$1,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=requireLongbits(),t.isNode=!!(typeof window<"u"&&window&&window.process&&window.process.versions&&window.process.versions.node),t.global=t.isNode&&window||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},t.isString=function(o){return typeof o=="string"||o instanceof String},t.isObject=function(o){return o&&typeof o=="object"},t.isset=t.isSet=function(o,s){var l=o[s];return l!=null&&o.hasOwnProperty(s)?typeof l!="object"||(Array.isArray(l)?l.length:Object.keys(l).length)>0:!1},t.Buffer=function(){try{var i=t.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(o){return typeof o=="number"?t.Buffer?t._Buffer_allocUnsafe(o):new t.Array(o):t.Buffer?t._Buffer_from(o):typeof Uint8Array>"u"?o:new Uint8Array(o)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(o){return o?t.LongBits.from(o).toHash():t.LongBits.zeroHash},t.longFromHash=function(o,s){var l=t.LongBits.fromHash(o);return t.Long?t.Long.fromBits(l.lo,l.hi,s):l.toNumber(!!s)};function e(i,o,s){for(var l=Object.keys(o),a=0;a<l.length;++a)(i[l[a]]===void 0||!s)&&(i[l[a]]=o[l[a]]);return i}t.merge=e,t.lcFirst=function(o){return o.charAt(0).toLowerCase()+o.substring(1)};function n(i){function o(s,l){if(!(this instanceof o))return new o(s,l);Object.defineProperty(this,"message",{get:function(){return s}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),l&&e(this,l)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(o){for(var s={},l=0;l<o.length;++l)s[o[l]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(s[a[c]]===1&&this[a[c]]!==void 0&&this[a[c]]!==null)return a[c]}},t.oneOfSetter=function(o){return function(s){for(var l=0;l<o.length;++l)o[l]!==s&&delete this[o[l]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var i=t.Buffer;if(!i){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=i.from!==Uint8Array.from&&i.from||function(s,l){return new i(s,l)},t._Buffer_allocUnsafe=i.allocUnsafe||function(s){return new i(s)}}}(minimal$1)),minimal$1}var writer=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(r,t,e){this.fn=r,this.len=t,this.next=void 0,this.val=e}function noop(){}function State(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function r(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function r(t){return new util$4.Array(t)};util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray));Writer$1.prototype._push=function r(t,e,n){return this.tail=this.tail.next=new Op(t,e,n),this.len+=e,this};function writeByte(r,t,e){t[e]=r&255}function writeVarint32(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}function VarintOp(r,t){this.len=r,this.next=void 0,this.val=t}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function r(t){return this.len+=(this.tail=this.tail.next=new VarintOp((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};Writer$1.prototype.int32=function r(t){return t<0?this._push(writeVarint64,10,LongBits$1.fromNumber(t)):this.uint32(t)};Writer$1.prototype.sint32=function r(t){return this.uint32((t<<1^t>>31)>>>0)};function writeVarint64(r,t,e){for(;r.hi;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}Writer$1.prototype.uint64=function r(t){var e=LongBits$1.from(t);return this._push(writeVarint64,e.length(),e)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function r(t){var e=LongBits$1.from(t).zzEncode();return this._push(writeVarint64,e.length(),e)};Writer$1.prototype.bool=function r(t){return this._push(writeByte,1,t?1:0)};function writeFixed32(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}Writer$1.prototype.fixed32=function r(t){return this._push(writeFixed32,4,t>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function r(t){var e=LongBits$1.from(t);return this._push(writeFixed32,4,e.lo)._push(writeFixed32,4,e.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function r(t){return this._push(util$4.float.writeFloatLE,4,t)};Writer$1.prototype.double=function r(t){return this._push(util$4.float.writeDoubleLE,8,t)};var writeBytes=util$4.Array.prototype.set?function r(t,e,n){e.set(t,n)}:function r(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};Writer$1.prototype.bytes=function r(t){var e=t.length>>>0;if(!e)return this._push(writeByte,1,0);if(util$4.isString(t)){var n=Writer$1.alloc(e=base64.length(t));base64.decode(t,n,0),t=n}return this.uint32(e)._push(writeBytes,e,t)};Writer$1.prototype.string=function r(t){var e=utf8$1.length(t);return e?this.uint32(e)._push(utf8$1.write,e,t):this._push(writeByte,1,0)};Writer$1.prototype.fork=function r(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this};Writer$1.prototype.reset=function r(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this};Writer$1.prototype.ldelim=function r(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this};Writer$1.prototype.finish=function r(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e};Writer$1._configure=function(r){BufferWriter$1=r,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}};BufferWriter.prototype.bytes=function r(t){util$3.isString(t)&&(t=util$3._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(BufferWriter.writeBytesBuffer,e,t),this};function writeStringBuffer(r,t,e){r.length<40?util$3.utf8.write(r,t,e):t.utf8Write?t.utf8Write(r,e):t.write(r,e)}BufferWriter.prototype.string=function r(t){var e=util$3.Buffer.byteLength(t);return this.uint32(e),e&&this._push(writeStringBuffer,e,t),this};BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(r,t){return RangeError("index out of range: "+r.pos+" + "+(t||1)+" > "+r.len)}function Reader$1(r){this.buf=r,this.pos=0,this.len=r.length}var create_array=typeof Uint8Array<"u"?function r(t){if(t instanceof Uint8Array||Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")}:function r(t){if(Array.isArray(t))return new Reader$1(t);throw Error("illegal buffer")},create=function r(){return util$2.Buffer?function(e){return(Reader$1.create=function(i){return util$2.Buffer.isBuffer(i)?new BufferReader$1(i):create_array(i)})(e)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice;Reader$1.prototype.uint32=function r(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return t}}();Reader$1.prototype.int32=function r(){return this.uint32()|0};Reader$1.prototype.sint32=function r(){var t=this.uint32();return t>>>1^-(t&1)|0};function readLongVarint(){var r=new LongBits(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,r}if(this.len-this.pos>4){for(;t<5;++t)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function r(){return this.uint32()!==0};function readFixed32_end(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}Reader$1.prototype.fixed32=function r(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function r(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function r(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var t=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Reader$1.prototype.double=function r(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var t=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Reader$1.prototype.bytes=function r(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw indexOutOfRange(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)};Reader$1.prototype.string=function r(){var t=this.bytes();return utf8.read(t,0,t.length)};Reader$1.prototype.skip=function r(t){if(typeof t=="number"){if(this.pos+t>this.len)throw indexOutOfRange(this,t);this.pos+=t}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};Reader$1._configure=function(r){BufferReader$1=r,Reader$1.create=create(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader(r){Reader.call(this,r)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)};BufferReader.prototype.string=function r(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};BufferReader._configure();var rpc={},service=Service,util=requireMinimal();(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service;function Service(r,t,e){if(typeof r!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!t,this.responseDelimited=!!e}Service.prototype.rpcCall=function r(t,e,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return util.asPromise(r,s,t,e,n,i);if(!s.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return s.rpcImpl(t,e[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(a,c){if(a)return s.emit("error",a,t),o(a);if(c===null){s.end(!0);return}if(!(c instanceof n))try{c=n[s.responseDelimited?"decodeDelimited":"decode"](c)}catch(u){return s.emit("error",u,t),o(u)}return s.emit("data",c,t),o(null,c)})}catch(l){s.emit("error",l,t),setTimeout(function(){o(l)},0);return}};Service.prototype.end=function r(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(r){var t=r;t.Service=service})(rpc);var roots={};(function(r){var t=r;t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=requireMinimal(),t.rpc=rpc,t.roots=roots,t.configure=e;function e(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}e()})(indexMinimal);var minimal=indexMinimal;const $Reader=minimal.Reader,$Writer=minimal.Writer,$util=minimal.util,$root=minimal.roots.default||(minimal.roots.default={});$root.Handshake=(()=>{function r(t){if(t)for(let e=Object.keys(t),n=0;n<e.length;++n)t[e[n]]!=null&&(this[e[n]]=t[e[n]])}return r.prototype.publicKey=$util.newBuffer([]),r.prototype.signature=$util.newBuffer([]),r.create=function(e){return new r(e)},r.encode=function(e,n){return n||(n=$Writer.create()),n.uint32(10).bytes(e.publicKey),n.uint32(18).bytes(e.signature),n},r.encodeDelimited=function(e,n){return this.encode(e,n).ldelim()},r.decode=function(e,n){e instanceof $Reader||(e=$Reader.create(e));let i=n===void 0?e.len:e.pos+n,o=new $root.Handshake;for(;e.pos<i;){let s=e.uint32();switch(s>>>3){case 1:{o.publicKey=e.bytes();break}case 2:{o.signature=e.bytes();break}default:e.skipType(s&7);break}}if(!o.hasOwnProperty("publicKey"))throw $util.ProtocolError("missing required 'publicKey'",{instance:o});if(!o.hasOwnProperty("signature"))throw $util.ProtocolError("missing required 'signature'",{instance:o});return o},r.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},r.verify=function(e){return typeof e!="object"||e===null?"object expected":e.publicKey&&typeof e.publicKey.length=="number"||$util.isString(e.publicKey)?e.signature&&typeof e.signature.length=="number"||$util.isString(e.signature)?null:"signature: buffer expected":"publicKey: buffer expected"},r.fromObject=function(e){if(e instanceof $root.Handshake)return e;let n=new $root.Handshake;return e.publicKey!=null&&(typeof e.publicKey=="string"?$util.base64.decode(e.publicKey,n.publicKey=$util.newBuffer($util.base64.length(e.publicKey)),0):e.publicKey.length>=0&&(n.publicKey=e.publicKey)),e.signature!=null&&(typeof e.signature=="string"?$util.base64.decode(e.signature,n.signature=$util.newBuffer($util.base64.length(e.signature)),0):e.signature.length>=0&&(n.signature=e.signature)),n},r.toObject=function(e,n){n||(n={});let i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=$util.newBuffer(i.publicKey))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=$util.newBuffer(i.signature)))),e.publicKey!=null&&e.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?$util.base64.encode(e.publicKey,0,e.publicKey.length):n.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),e.signature!=null&&e.hasOwnProperty("signature")&&(i.signature=n.bytes===String?$util.base64.encode(e.signature,0,e.signature.length):n.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/Handshake"},r})();$root.HandshakeResponse=(()=>{function r(t){if(t)for(let e=Object.keys(t),n=0;n<e.length;++n)t[e[n]]!=null&&(this[e[n]]=t[e[n]])}return r.prototype.publicKey=$util.newBuffer([]),r.prototype.signature=$util.newBuffer([]),r.create=function(e){return new r(e)},r.encode=function(e,n){return n||(n=$Writer.create()),n.uint32(10).bytes(e.publicKey),n.uint32(18).bytes(e.signature),n},r.encodeDelimited=function(e,n){return this.encode(e,n).ldelim()},r.decode=function(e,n){e instanceof $Reader||(e=$Reader.create(e));let i=n===void 0?e.len:e.pos+n,o=new $root.HandshakeResponse;for(;e.pos<i;){let s=e.uint32();switch(s>>>3){case 1:{o.publicKey=e.bytes();break}case 2:{o.signature=e.bytes();break}default:e.skipType(s&7);break}}if(!o.hasOwnProperty("publicKey"))throw $util.ProtocolError("missing required 'publicKey'",{instance:o});if(!o.hasOwnProperty("signature"))throw $util.ProtocolError("missing required 'signature'",{instance:o});return o},r.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},r.verify=function(e){return typeof e!="object"||e===null?"object expected":e.publicKey&&typeof e.publicKey.length=="number"||$util.isString(e.publicKey)?e.signature&&typeof e.signature.length=="number"||$util.isString(e.signature)?null:"signature: buffer expected":"publicKey: buffer expected"},r.fromObject=function(e){if(e instanceof $root.HandshakeResponse)return e;let n=new $root.HandshakeResponse;return e.publicKey!=null&&(typeof e.publicKey=="string"?$util.base64.decode(e.publicKey,n.publicKey=$util.newBuffer($util.base64.length(e.publicKey)),0):e.publicKey.length>=0&&(n.publicKey=e.publicKey)),e.signature!=null&&(typeof e.signature=="string"?$util.base64.decode(e.signature,n.signature=$util.newBuffer($util.base64.length(e.signature)),0):e.signature.length>=0&&(n.signature=e.signature)),n},r.toObject=function(e,n){n||(n={});let i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=$util.newBuffer(i.publicKey))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=$util.newBuffer(i.signature)))),e.publicKey!=null&&e.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?$util.base64.encode(e.publicKey,0,e.publicKey.length):n.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),e.signature!=null&&e.hasOwnProperty("signature")&&(i.signature=n.bytes===String?$util.base64.encode(e.signature,0,e.signature.length):n.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/HandshakeResponse"},r})();const List=$root.List=(()=>{function r(t){if(this.entries=[],t)for(let e=Object.keys(t),n=0;n<e.length;++n)t[e[n]]!=null&&(this[e[n]]=t[e[n]])}return r.prototype.entries=$util.emptyArray,r.create=function(e){return new r(e)},r.encode=function(e,n){if(n||(n=$Writer.create()),e.entries!=null&&e.entries.length)for(let i=0;i<e.entries.length;++i)$root.List.Entry.encode(e.entries[i],n.uint32(10).fork()).ldelim();return n},r.encodeDelimited=function(e,n){return this.encode(e,n).ldelim()},r.decode=function(e,n){e instanceof $Reader||(e=$Reader.create(e));let i=n===void 0?e.len:e.pos+n,o=new $root.List;for(;e.pos<i;){let s=e.uint32();switch(s>>>3){case 1:{o.entries&&o.entries.length||(o.entries=[]),o.entries.push($root.List.Entry.decode(e,e.uint32()));break}default:e.skipType(s&7);break}}return o},r.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},r.verify=function(e){if(typeof e!="object"||e===null)return"object expected";if(e.entries!=null&&e.hasOwnProperty("entries")){if(!Array.isArray(e.entries))return"entries: array expected";for(let n=0;n<e.entries.length;++n){let i=$root.List.Entry.verify(e.entries[n]);if(i)return"entries."+i}}return null},r.fromObject=function(e){if(e instanceof $root.List)return e;let n=new $root.List;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".List.entries: array expected");n.entries=[];for(let i=0;i<e.entries.length;++i){if(typeof e.entries[i]!="object")throw TypeError(".List.entries: object expected");n.entries[i]=$root.List.Entry.fromObject(e.entries[i])}}return n},r.toObject=function(e,n){n||(n={});let i={};if((n.arrays||n.defaults)&&(i.entries=[]),e.entries&&e.entries.length){i.entries=[];for(let o=0;o<e.entries.length;++o)i.entries[o]=$root.List.Entry.toObject(e.entries[o],n)}return i},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/List"},r.Entry=function(){function t(e){if(e)for(let n=Object.keys(e),i=0;i<n.length;++i)e[n[i]]!=null&&(this[n[i]]=e[n[i]])}return t.prototype.index=0,t.prototype.size=0,t.prototype.name="",t.create=function(n){return new t(n)},t.encode=function(n,i){return i||(i=$Writer.create()),i.uint32(8).uint32(n.index),i.uint32(16).uint32(n.size),i.uint32(26).string(n.name),i},t.encodeDelimited=function(n,i){return this.encode(n,i).ldelim()},t.decode=function(n,i){n instanceof $Reader||(n=$Reader.create(n));let o=i===void 0?n.len:n.pos+i,s=new $root.List.Entry;for(;n.pos<o;){let l=n.uint32();switch(l>>>3){case 1:{s.index=n.uint32();break}case 2:{s.size=n.uint32();break}case 3:{s.name=n.string();break}default:n.skipType(l&7);break}}if(!s.hasOwnProperty("index"))throw $util.ProtocolError("missing required 'index'",{instance:s});if(!s.hasOwnProperty("size"))throw $util.ProtocolError("missing required 'size'",{instance:s});if(!s.hasOwnProperty("name"))throw $util.ProtocolError("missing required 'name'",{instance:s});return s},t.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},t.verify=function(n){return typeof n!="object"||n===null?"object expected":$util.isInteger(n.index)?$util.isInteger(n.size)?$util.isString(n.name)?null:"name: string expected":"size: integer expected":"index: integer expected"},t.fromObject=function(n){if(n instanceof $root.List.Entry)return n;let i=new $root.List.Entry;return n.index!=null&&(i.index=n.index>>>0),n.size!=null&&(i.size=n.size>>>0),n.name!=null&&(i.name=String(n.name)),i},t.toObject=function(n,i){i||(i={});let o={};return i.defaults&&(o.index=0,o.size=0,o.name=""),n.index!=null&&n.hasOwnProperty("index")&&(o.index=n.index),n.size!=null&&n.hasOwnProperty("size")&&(o.size=n.size),n.name!=null&&n.hasOwnProperty("name")&&(o.name=n.name),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},t.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/List.Entry"},t}(),r})();$root.Progress=(()=>{function r(t){if(t)for(let e=Object.keys(t),n=0;n<e.length;++n)t[e[n]]!=null&&(this[e[n]]=t[e[n]])}return r.prototype.index=0,r.prototype.progress=0,r.create=function(e){return new r(e)},r.encode=function(e,n){return n||(n=$Writer.create()),n.uint32(8).uint32(e.index),n.uint32(16).uint32(e.progress),n},r.encodeDelimited=function(e,n){return this.encode(e,n).ldelim()},r.decode=function(e,n){e instanceof $Reader||(e=$Reader.create(e));let i=n===void 0?e.len:e.pos+n,o=new $root.Progress;for(;e.pos<i;){let s=e.uint32();switch(s>>>3){case 1:{o.index=e.uint32();break}case 2:{o.progress=e.uint32();break}default:e.skipType(s&7);break}}if(!o.hasOwnProperty("index"))throw $util.ProtocolError("missing required 'index'",{instance:o});if(!o.hasOwnProperty("progress"))throw $util.ProtocolError("missing required 'progress'",{instance:o});return o},r.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},r.verify=function(e){return typeof e!="object"||e===null?"object expected":$util.isInteger(e.index)?$util.isInteger(e.progress)?null:"progress: integer expected":"index: integer expected"},r.fromObject=function(e){if(e instanceof $root.Progress)return e;let n=new $root.Progress;return e.index!=null&&(n.index=e.index>>>0),e.progress!=null&&(n.progress=e.progress>>>0),n},r.toObject=function(e,n){n||(n={});let i={};return n.defaults&&(i.index=0,i.progress=0),e.index!=null&&e.hasOwnProperty("index")&&(i.index=e.index),e.progress!=null&&e.hasOwnProperty("progress")&&(i.progress=e.progress),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/Progress"},r})();$root.Chunk=(()=>{function r(t){if(t)for(let e=Object.keys(t),n=0;n<e.length;++n)t[e[n]]!=null&&(this[e[n]]=t[e[n]])}return r.prototype.chunk=$util.newBuffer([]),r.create=function(e){return new r(e)},r.encode=function(e,n){return n||(n=$Writer.create()),n.uint32(10).bytes(e.chunk),n},r.encodeDelimited=function(e,n){return this.encode(e,n).ldelim()},r.decode=function(e,n){e instanceof $Reader||(e=$Reader.create(e));let i=n===void 0?e.len:e.pos+n,o=new $root.Chunk;for(;e.pos<i;){let s=e.uint32();switch(s>>>3){case 1:{o.chunk=e.bytes();break}default:e.skipType(s&7);break}}if(!o.hasOwnProperty("chunk"))throw $util.ProtocolError("missing required 'chunk'",{instance:o});return o},r.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},r.verify=function(e){return typeof e!="object"||e===null?"object expected":e.chunk&&typeof e.chunk.length=="number"||$util.isString(e.chunk)?null:"chunk: buffer expected"},r.fromObject=function(e){if(e instanceof $root.Chunk)return e;let n=new $root.Chunk;return e.chunk!=null&&(typeof e.chunk=="string"?$util.base64.decode(e.chunk,n.chunk=$util.newBuffer($util.base64.length(e.chunk)),0):e.chunk.length>=0&&(n.chunk=e.chunk)),n},r.toObject=function(e,n){n||(n={});let i={};return n.defaults&&(n.bytes===String?i.chunk="":(i.chunk=[],n.bytes!==Array&&(i.chunk=$util.newBuffer(i.chunk)))),e.chunk!=null&&e.hasOwnProperty("chunk")&&(i.chunk=n.bytes===String?$util.base64.encode(e.chunk,0,e.chunk.length):n.bytes===Array?Array.prototype.slice.call(e.chunk):e.chunk),i},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(e){return e===void 0&&(e="type.googleapis.com"),e+"/Chunk"},r})();const Packet=$root.Packet=(()=>{function r(e){if(e)for(let n=Object.keys(e),i=0;i<n.length;++i)e[n[i]]!=null&&(this[n[i]]=e[n[i]])}r.prototype.handshake=null,r.prototype.handshakeResponse=null,r.prototype.list=null,r.prototype.progress=null,r.prototype.chunk=null;let t;return Object.defineProperty(r.prototype,"value",{get:$util.oneOfGetter(t=["handshake","handshakeResponse","list","progress","chunk"]),set:$util.oneOfSetter(t)}),r.create=function(n){return new r(n)},r.encode=function(n,i){return i||(i=$Writer.create()),n.handshake!=null&&Object.hasOwnProperty.call(n,"handshake")&&$root.Handshake.encode(n.handshake,i.uint32(10).fork()).ldelim(),n.handshakeResponse!=null&&Object.hasOwnProperty.call(n,"handshakeResponse")&&$root.HandshakeResponse.encode(n.handshakeResponse,i.uint32(18).fork()).ldelim(),n.list!=null&&Object.hasOwnProperty.call(n,"list")&&$root.List.encode(n.list,i.uint32(26).fork()).ldelim(),n.progress!=null&&Object.hasOwnProperty.call(n,"progress")&&$root.Progress.encode(n.progress,i.uint32(34).fork()).ldelim(),n.chunk!=null&&Object.hasOwnProperty.call(n,"chunk")&&$root.Chunk.encode(n.chunk,i.uint32(42).fork()).ldelim(),i},r.encodeDelimited=function(n,i){return this.encode(n,i).ldelim()},r.decode=function(n,i){n instanceof $Reader||(n=$Reader.create(n));let o=i===void 0?n.len:n.pos+i,s=new $root.Packet;for(;n.pos<o;){let l=n.uint32();switch(l>>>3){case 1:{s.handshake=$root.Handshake.decode(n,n.uint32());break}case 2:{s.handshakeResponse=$root.HandshakeResponse.decode(n,n.uint32());break}case 3:{s.list=$root.List.decode(n,n.uint32());break}case 4:{s.progress=$root.Progress.decode(n,n.uint32());break}case 5:{s.chunk=$root.Chunk.decode(n,n.uint32());break}default:n.skipType(l&7);break}}return s},r.decodeDelimited=function(n){return n instanceof $Reader||(n=new $Reader(n)),this.decode(n,n.uint32())},r.verify=function(n){if(typeof n!="object"||n===null)return"object expected";let i={};if(n.handshake!=null&&n.hasOwnProperty("handshake")){i.value=1;{let o=$root.Handshake.verify(n.handshake);if(o)return"handshake."+o}}if(n.handshakeResponse!=null&&n.hasOwnProperty("handshakeResponse")){if(i.value===1)return"value: multiple values";i.value=1;{let o=$root.HandshakeResponse.verify(n.handshakeResponse);if(o)return"handshakeResponse."+o}}if(n.list!=null&&n.hasOwnProperty("list")){if(i.value===1)return"value: multiple values";i.value=1;{let o=$root.List.verify(n.list);if(o)return"list."+o}}if(n.progress!=null&&n.hasOwnProperty("progress")){if(i.value===1)return"value: multiple values";i.value=1;{let o=$root.Progress.verify(n.progress);if(o)return"progress."+o}}if(n.chunk!=null&&n.hasOwnProperty("chunk")){if(i.value===1)return"value: multiple values";i.value=1;{let o=$root.Chunk.verify(n.chunk);if(o)return"chunk."+o}}return null},r.fromObject=function(n){if(n instanceof $root.Packet)return n;let i=new $root.Packet;if(n.handshake!=null){if(typeof n.handshake!="object")throw TypeError(".Packet.handshake: object expected");i.handshake=$root.Handshake.fromObject(n.handshake)}if(n.handshakeResponse!=null){if(typeof n.handshakeResponse!="object")throw TypeError(".Packet.handshakeResponse: object expected");i.handshakeResponse=$root.HandshakeResponse.fromObject(n.handshakeResponse)}if(n.list!=null){if(typeof n.list!="object")throw TypeError(".Packet.list: object expected");i.list=$root.List.fromObject(n.list)}if(n.progress!=null){if(typeof n.progress!="object")throw TypeError(".Packet.progress: object expected");i.progress=$root.Progress.fromObject(n.progress)}if(n.chunk!=null){if(typeof n.chunk!="object")throw TypeError(".Packet.chunk: object expected");i.chunk=$root.Chunk.fromObject(n.chunk)}return i},r.toObject=function(n,i){i||(i={});let o={};return n.handshake!=null&&n.hasOwnProperty("handshake")&&(o.handshake=$root.Handshake.toObject(n.handshake,i),i.oneofs&&(o.value="handshake")),n.handshakeResponse!=null&&n.hasOwnProperty("handshakeResponse")&&(o.handshakeResponse=$root.HandshakeResponse.toObject(n.handshakeResponse,i),i.oneofs&&(o.value="handshakeResponse")),n.list!=null&&n.hasOwnProperty("list")&&(o.list=$root.List.toObject(n.list,i),i.oneofs&&(o.value="list")),n.progress!=null&&n.hasOwnProperty("progress")&&(o.progress=$root.Progress.toObject(n.progress,i),i.oneofs&&(o.value="progress")),n.chunk!=null&&n.hasOwnProperty("chunk")&&(o.chunk=$root.Chunk.toObject(n.chunk,i),i.oneofs&&(o.value="chunk")),o},r.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},r.getTypeUrl=function(n){return n===void 0&&(n="type.googleapis.com"),n+"/Packet"},r})();class NetworkSender{constructor(t,e,n,i,o,s){this.URI=t,this.messageCallback=e,this.createRoomCallback=n,this.leaveRoomCallback=i,this.joinRoomCallback=o,this.errorCallback=s}ROOM_SIZE=2;IV_SIZE=12;DESTINATION=1;keyPair;HMACKey;sharedKey;webSocket;async init(){this.webSocket=new WebSocket(this.URI),this.webSocket.onopen=this.onOpen.bind(this),this.webSocket.onclose=this.onClose.bind(this),this.webSocket.onerror=this.onError.bind(this),this.webSocket.onmessage=this.onMessage.bind(this)}async onOpen(){try{this.keyPair=await window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey"])}catch(t){return this.error("Failed to generate public-private key: "+t)}try{this.HMACKey=await window.crypto.subtle.generateKey({name:"HMAC",hash:{name:"SHA-256"}},!0,["sign","verify"])}catch(t){return this.error("Failed to generate HMAC key: "+t)}this.sendJSON({type:"create",size:this.ROOM_SIZE})}async onClose(){return this.error("The connection to the network was closed.")}async onError(){return this.error("The connection to the network was closed due to an error.")}async onMessage(t){if(t.data instanceof Blob){const e=await t.data.arrayBuffer(),n=new Uint8Array(e).slice(1);if(this.sharedKey){const i=n.slice(0,this.IV_SIZE),o=n.slice(this.IV_SIZE);try{const s=new Uint8Array(await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},this.sharedKey,o));return this.messageCallback(s)}catch(s){return this.error("Failed to decrypt: "+s)}}else{const i=Packet.decode(n);switch(i.value){case"handshakeResponse":return this.onHandshakeResponse(i.handshakeResponse)}}}else{const e=JSON.parse(t.data);switch(e.type){case"create":return this.onCreateRoom(e.id);case"leave":return this.onLeaveRoom();case"join":return this.onJoinRoom();case"error":return this.error(e.message)}}}async onLeaveRoom(){this.sharedKey=void 0,this.leaveRoomCallback()}async onCreateRoom(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");let e;try{e=await window.crypto.subtle.exportKey("raw",this.HMACKey)}catch(i){return this.error("Failed to export HMAC key: "+i)}const n=t+"-"+btoa(String.fromCharCode(...new Uint8Array(e)));this.createRoomCallback(n)}async onJoinRoom(){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let t;try{t=new Uint8Array(await window.crypto.subtle.exportKey("raw",this.keyPair.publicKey))}catch(o){return this.error("Failed to export public key: "+o)}let e;try{e=new Uint8Array(await window.crypto.subtle.sign("HMAC",this.HMACKey,t))}catch(o){return this.error("Failed to export HMAC key: "+o)}const i=Packet.encode({handshake:{publicKey:t,signature:e}}).finish();this.send(i)}async onHandshakeResponse(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let e;try{e=await window.crypto.subtle.verify("HMAC",this.HMACKey,t.signature,t.publicKey)}catch(i){return this.error("Failed to verify public key: "+i)}if(!e)return this.error("The signature from the receiver was invalid.");let n;try{n=await window.crypto.subtle.importKey("raw",t.publicKey,{name:"ECDH",namedCurve:"P-256"},!1,[])}catch(i){return this.error("Failed to import public key: "+i)}try{this.sharedKey=await window.crypto.subtle.deriveKey({name:"ECDH",public:n},this.keyPair.privateKey,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])}catch(i){return this.error("Failed to derive key: "+i)}this.joinRoomCallback()}close(){this.webSocket&&this.webSocket.readyState===this.webSocket.OPEN&&this.sendJSON({type:"leave"})}error(t){this.close(),this.errorCallback(t)}async sendJSON(t){this.webSocket?.send(JSON.stringify(t))}async send(t){const e=new Uint8Array([this.DESTINATION]);if(this.sharedKey){const n=window.crypto.getRandomValues(new Uint8Array(this.IV_SIZE));try{const i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},this.sharedKey,t),o=new Uint8Array(e.byteLength+n.byteLength+i.byteLength);o.set(e),o.set(n,e.length),o.set(new Uint8Array(i),n.length+e.length),this.webSocket.send(o)}catch(i){return this.error("Failed to encrypt: "+i)}}else{const n=new Uint8Array(e.byteLength+t.byteLength);n.set(e),n.set(t,e.length),this.webSocket.send(n)}}}const _tmpl$$5=template('<button class="transition border w-fit font-bold border-[#4a4f58] py-2 px-6 rounded hover:bg-[#292e34] mr-2">Return to Home'),_tmpl$2$1=template('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><svg class="w-32 h-32 mb-[-20px]" viewBox="0 0 100 125.0125"><path fill="#ff3b3b" d="M50,14.57A35.44,35.44,0,1,0,85.43,50,35.47,35.47,0,0,0,50,14.57Zm-1.74,15.1a1.74,1.74,0,0,1,3.48,0V57.6a1.74,1.74,0,0,1-3.48,0ZM50,71a3.08,3.08,0,1,1,3.07-3.08A3.07,3.07,0,0,1,50,71Z"></path></svg><div class="text-4xl text-white">Error</div><div class="text-xl text-white max-w-lg mt-3 mb-5 text-center"></div><div class="flex flex-row">'),_tmpl$3=template('<button class="transition border w-fit font-bold border-[#4a4f58] py-2 px-6 rounded hover:bg-[#292e34] mr-2">Retry'),ErrorPage=r=>{const t=()=>{location.reload()},e=()=>{history.pushState("",document.title,window.location.pathname+window.location.search),location.reload()};return(()=>{const n=_tmpl$2$1(),i=n.firstChild,o=i.nextSibling,s=o.nextSibling,l=s.nextSibling;return insert(s,()=>r.message),insert(l,createComponent(Show,{get when(){return location.hash},get fallback(){return(()=>{const a=_tmpl$3();return a.$$click=t,a})()},get children(){const a=_tmpl$$5();return a.$$click=e,a}})),n})()};delegateEvents(["click"]);const _tmpl$$4=template('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><div class="text-4xl max-w-lg mb-3">Your file(s) are ready to send</div><div class="text-lg max-w-lg mb-6">Copy the link to share your file(s). Keep your <b>browser tab open</b> as data will be sent in real-time rather than being uploaded onto a server.</div><input type="text" placeholder="Type a name..." readonly class="max-w-lg mb-4 focus:border-[#9ea6b5] border rounded bg-transparent border-[#4a4f58] w-full py-4 px-3 text-white leading-tight focus:outline-none"><button class="transition w-full max-w-lg font-bold bg-[#0060df] py-3 px-6 rounded hover:bg-[#2e75d1]">'),InvitePage=()=>{const[r,t]=createSignal(!1),e=()=>{navigator.clipboard.writeText(window.location.href),t(!0),setTimeout(()=>t(!1),1e3)};return(()=>{const n=_tmpl$$4(),i=n.firstChild,o=i.nextSibling,s=o.nextSibling,l=s.nextSibling;return l.$$click=e,insert(l,createComponent(Show,{get when(){return r()},fallback:"Copy link",children:"Copied!"})),createRenderEffect(()=>s.value=window.location.href),n})()};delegateEvents(["click"]);const _tmpl$$3=template('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8"><svg class="w-16 h-16 text-[#0f1013] animate-spin mb-7 dark:text-gray-600 fill-[#fff]" viewBox="0 0 100 101" fill="none"><path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"></path><path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"></path></svg><div class="text-white text-xl max-w-lg select-none text-center">'),LoadingPage=r=>(()=>{const t=_tmpl$$3(),e=t.firstChild,n=e.nextSibling;return insert(n,()=>r.message),t})(),_tmpl$$2=template(`<div class="flex h-fit min-dvh-screen justify-center md:items-center items-start"><div class="flex flex-col-reverse dvh-screen md:h-fit md:flex-row max-w-[53rem] bg-[#23272c] shadow-lg rounded-md overflow-hidden text-center"><div class="flex flex-col items-center justify-center h-full border-2 border-dashed rounded-md border-[#64676e] px-[100px] py-[150px]"><svg class="h-10 w-10 mb-3" fill="#fff" viewBox="0 0 32 32"><path d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 
                14-14 14 6.28 14 14-6.28 14.032-14 14.032zM23 15h-6v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1v6h-6c-0.552 0-1 0.448-1 1s0.448 1 1 1h6v6c0 
                0.552 0.448 1 1 1s1-0.448 1-1v-6h6c0.552 0 1-0.448 1-1s-0.448-1-1-1z"></path></svg><div class="text-2xl w-max">Drag and drop files</div><div class="text-l w-max mb-6">or click to select files</div><button class="transition w-fit font-bold bg-[#0060df] py-3 px-6 rounded hover:bg-[#2e75d1] mr-2">Select files to share</button><input multiple type="file"></div><div class="flex flex-col bg-[#101214] pb-7 w-full md:pb-0 md:w-[21rem]"><div class="flex flex-row m-7 mb-6 items-center"><div class="bg-[#0060df] h-14 w-14 p-1 rounded-lg mr-5"><svg viewBox="0 0 36 45"><path fill="#fff" d="M18,2A16,16,0,1,0,34,18,16,16,0,0,0,18,2Zm9.57,18.18C24.45,21.85,18,24.89,14.5,26.57A3.6,3.6,0,0,1,13,26.9a3.45,3.45,0,
                  0,1-2-.63,3.78,3.78,0,0,1-1.6-3.13V21.43h2.29v1.71a1.52,1.52,0,0,0,.62,1.26,1.2,1.2,0,0,0,1.19.1c3.53-1.67,9.9-4.7,13-6.33a.21.21,0,
                  0,0,0-.32c-3.1-1.66-9.46-4.69-13-6.34a1.19,1.19,0,0,0-1.2.1,1.51,1.51,0,0,0-.62,1.26v2.74a1.13,1.13,0,0,0,1.05,1.25h2.38v2.29H12.77a3.41,
                  3.41,0,0,1-3.34-3.53V12.87A3.77,3.77,0,0,1,11,9.74a3.42,3.42,0,0,1,3.47-.29c3.53,1.66,9.93,4.71,13.06,6.38a2.48,2.48,0,0,1,0,
                  4.35Zm-10.14-1V16.86h2.29v2.29Z"></path></svg></div><div class="text-5xl font-bold mb-[5px] select-none text-white">Share</div></div><div class="mx-7 text-gray-300 text-justify">Share is a real-time, peer-to-peer file transfer platform with a focus on security. With Share, you can send files of any size, and you can have peace of mind knowing that your files will be sent using end-to-end encryption and will never be stored on any server.`),SelectFilePage=r=>{const[t,e]=createSignal(!1),n=u=>{const h=u.target;h.files&&h.files.length>0&&r.selectFiles(h.files)},i=u=>{u.preventDefault(),u.dataTransfer&&u.dataTransfer.files&&u.dataTransfer.files.length>0&&r.selectFiles(u.dataTransfer.files)},o=u=>{u.preventDefault(),e(!0)},s=u=>{u.target===c&&!c?.contains(u.fromElement)&&e(!1)},l=()=>{a?.click()};let a,c;return(()=>{const u=_tmpl$$2(),h=u.firstChild,f=h.firstChild,w=f.firstChild,d=w.nextSibling,p=d.nextSibling,y=p.nextSibling,b=y.nextSibling;f.addEventListener("dragleave",s),f.addEventListener("dragover",o),f.addEventListener("drop",i);const m=c;typeof m=="function"?use(m,f):c=f,y.$$click=l,b.addEventListener("change",n);const $=a;return typeof $=="function"?use($,b):a=b,b.style.setProperty("display","none"),createRenderEffect(k=>style(f,t()?{"border-color":"whitesmoke"}:{},k)),u})()};delegateEvents(["click"]);const _tmpl$$1=template('<div class="flex flex-col h-fit min-dvh-screen justify-center items-center p-8 text-center"><div class="text-4xl max-w-lg mb-3">Transferring files</div><div class="text-lg max-w-lg mb-6 px-3">Keep your <b>browser tab open</b> as data is sent in real-time.</div><div class="flex flex-col gap-3 w-full items-center">'),_tmpl$2=template('<div class="flex flex-col bg-[#23272c] shadow-lg rounded-md text-left p-4 w-full max-w-[500px]"><div class="flex flex-row"><div class="mr-2"><svg class="w-12 h-12 invert" viewBox="0 0 100 100"><path d="m79.46,22.56l-6.67-7.04-3.92-4.14c-.33-.35-.7-.62-1.1-.84-.23-.13-.48-.23-.73-.31-.07-.02-.13-.05-.2-.07h0s0,0,0,0v11.08c0,1.26.87,2.32,2.04,2.61.21.05.43.09.66.09h10.81s0,0,0,0h0c-.23-.51-.52-.99-.9-1.39Z"></path><path d="m27.79,10c-4.75,0-8.61,4.12-8.61,9.19v61.62c0,5.07,3.86,9.19,8.61,9.19h44.41c4.75,0,8.61-4.12,8.61-9.19V27.2h-11.26c-3.28,0-5.95-2.67-5.95-5.95v-11.25H27.79Zm4.58,17.57h17.62c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62h-17.62c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62Zm35.24,44.86h-35.24c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62h35.24c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62Zm0-24.05c.9,0,1.62.72,1.62,1.62s-.72,1.62-1.62,1.62h-35.24c-.9,0-1.62-.72-1.62-1.62s.72-1.62,1.62-1.62h35.24Z"></path></svg></div><div class="flex flex-col items-start"><div class="font-bold"></div><div></div></div></div><div class="flex flex-col px-2"><div class="text-[#2f88fc] font-bold mb-1 mt-1">%</div><div class="w-full bg-gray-700 rounded-full h-1.5 mb-2"><div class="bg-[#2f88fc] h-1.5 rounded-full">'),TransferFilePage=r=>{const t=e=>{const n=e==0?0:Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,n)).toFixed(2)+" "+["B","KB","MB","GB","TB"][n]};return(()=>{const e=_tmpl$$1(),n=e.firstChild,i=n.nextSibling,o=i.nextSibling;return insert(o,createComponent(For,{get each(){return r.files},children:s=>(()=>{const l=_tmpl$2(),a=l.firstChild,c=a.firstChild,u=c.nextSibling,h=u.firstChild,f=h.nextSibling,w=a.nextSibling,d=w.firstChild,p=d.firstChild,y=d.nextSibling,b=y.firstChild;return insert(h,()=>s.name),insert(f,()=>t(s.size)),insert(d,()=>s.progress(),p),createRenderEffect(()=>s.progress()+"%"!=null?b.style.setProperty("width",s.progress()+"%"):b.style.removeProperty("width")),l})()})),e})()},_tmpl$=template(`<div class="flex flex-col h-fit min-dvh-screen justify-center items-center px-8 text-center"><svg class="w-28 h-28" viewBox="0 0 100 125"><g transform="translate(0,-952.36218)"><path style="opacity:1;color:#000000;fill:#3bff55;stroke:none;stroke-width:7.09253644999999990;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate" d="M 50 8 C 26.80404 8 8 26.80404 8 50 C 8 73.19596 26.80404 92 50 92 C 73.19596 92 92 73.19596 92 50 C 92 26.80404 73.19596 8 50 8 z M 71.1875 32.96875 A 
          2.0001995 2.0001995 0 0 1 72.6875 36.375 L 45.4375 64.375 A 2.0001995 2.0001995 0 0 1 42.5625 64.375 L 29.8125 51.28125 A 2.0001995 2.0001995 0 1 1 32.6875 
          48.5 L 44 60.125 L 69.8125 33.59375 A 2.0001995 2.0001995 0 0 1 71.1875 32.96875 z " transform="translate(0,952.36218)"></path></g></svg><div class="text-4xl text-white">Transfer Completed</div><div class="text-xl text-white max-w-lg mt-3 mb-5 text-center">The file transfer has been completed successfully &mdash; you may now close the browser tab.</div><button class="transition border w-fit font-bold border-[#4a4f58] py-2 px-6 rounded hover:bg-[#292e34] mr-2">Return to Home`),TransferFileCompletedPage=()=>{const r=()=>{history.pushState("",document.title,window.location.pathname+window.location.search),location.reload()};return(()=>{const t=_tmpl$(),e=t.firstChild,n=e.nextSibling,i=n.nextSibling,o=i.nextSibling;return o.$$click=r,t})()};delegateEvents(["click"]);const Sender=()=>{let t=[],e,n,i,o;const[s,l]=createSignal({type:"selectFile"}),a=g=>{const v=Packet.decode(g);switch(v.value){case"progress":return w(v.progress)}},c=g=>{location.hash=g,l({type:"invite"})},u=()=>{for(const g of t)g.setProgress(0);s().type==="transferFile"&&l({type:"invite"})},h=async()=>{l({type:"transferFile"}),await m(),await b()},f=g=>{l({type:"error",message:g})},w=g=>{const v=t.at(g.index);if(!v)return k.error("Expected valid progress packet index.");g.progress===100&&g.index===t.length-1&&(l({type:"transferFileCompleted"}),k.close()),v.setProgress(g.progress)},d=g=>{if(s().type==="selectFile"){if(g.length===0)return k.error("Expected file list to not be empty.");for(let v=0;v<g.length;v++){const x=g[v],[C,O]=createSignal(0);t.push({index:v,file:x,progress:C,setProgress:O,name:x.name,size:x.size})}l({type:"loading",message:"Attempting to create room..."}),k.init()}},p=()=>{const g=new Uint8Array($.result),x=Packet.encode({chunk:{chunk:g}}).finish();k.send(x),y()},y=()=>{if(s().type!=="transferFile")return;if(i===0){if(e===t.length-1)return;e++,n=0,o=65535,i=t[e].size}const g=t[e].file;if(!g)return k.error("File handle is invalid.");i<o&&(o=i);const v=g.slice(n,n+o);i-=o,n+=o,$.readAsArrayBuffer(v)},b=()=>{e=0,n=0,o=65535,i=t[e].size,y()},m=()=>{const g=List.create({entries:[]});for(const C of t)g.entries.push({index:C.index,name:C.name,size:C.size});const x=Packet.encode({list:g}).finish();k.send(x)},$=new FileReader;$.onload=p;const k=new NetworkSender("wss://vldr.org:8080/relay",a,c,u,h,f);return createComponent(Switch,{get children(){return[createComponent(Match,{get when(){return s().type==="error"},get children(){return createComponent(ErrorPage,{get message(){return s().message}})}}),createComponent(Match,{get when(){return s().type==="loading"},get children(){return createComponent(LoadingPage,{get message(){return s().message}})}}),createComponent(Match,{get when(){return s().type==="invite"},get children(){return createComponent(InvitePage,{})}}),createComponent(Match,{get when(){return s().type==="selectFile"},get children(){return createComponent(SelectFilePage,{selectFiles:d})}}),createComponent(Match,{get when(){return s().type==="transferFile"},get children(){return createComponent(TransferFilePage,{files:t})}}),createComponent(Match,{get when(){return s().type==="transferFileCompleted"},get children(){return createComponent(TransferFileCompletedPage,{})}})]}})};class NetworkReceiver{constructor(t,e,n,i,o){this.inviteCode=e,this.messageCallback=n,this.errorCallback=i,this.leaveRoomCallback=o,this.webSocket=new WebSocket(t),this.webSocket.onopen=this.onOpen.bind(this),this.webSocket.onclose=this.onClose.bind(this),this.webSocket.onerror=this.onError.bind(this),this.webSocket.onmessage=this.onMessage.bind(this)}IV_SIZE=12;DESTINATION=0;keyPair;HMACKey;sharedKey;webSocket;async init(){if(!this.inviteCode)return this.error("Invite code is invalid.");const t=this.inviteCode.lastIndexOf("-");if(t===-1)return this.error("Invalid URL structure.");const e=this.inviteCode.slice(0,t),n=this.inviteCode.slice(t+1);if(!n||!e)return this.error("Invalid URL components.");let i;try{i=Uint8Array.from(atob(n),o=>o.charCodeAt(0))}catch(o){return this.error("Failed to decode key data: "+o)}try{this.HMACKey=await window.crypto.subtle.importKey("raw",i,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign","verify"])}catch(o){return this.error("Failed to import HMAC key: "+o)}try{this.keyPair=await window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey"])}catch(o){return this.error("Failed to generate public-private key: "+o)}this.sendJSON({type:"join",id:e})}async onOpen(){await this.init()}async onClose(){return this.error("The connection to the network was closed.")}async onError(){return this.error("The connection to the network was closed due to an error.")}async onMessage(t){if(t.data instanceof Blob){const e=await t.data.arrayBuffer(),n=new Uint8Array(e).slice(1);if(this.sharedKey){const i=n.slice(0,this.IV_SIZE),o=n.slice(this.IV_SIZE);try{const s=new Uint8Array(await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},this.sharedKey,o));return this.messageCallback(s)}catch(s){return this.error("Failed to decrypt: "+s)}}else{const i=Packet.decode(n);switch(i.value){case"handshake":return this.onHandshake(i.handshake)}}}else{const e=JSON.parse(t.data);switch(e.type){case"leave":return this.onLeaveRoom();case"error":return this.error(e.message)}}}async onLeaveRoom(){this.close(),this.leaveRoomCallback()}async onHandshake(t){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let e;try{e=await window.crypto.subtle.verify("HMAC",this.HMACKey,t.signature,t.publicKey)}catch(i){return this.error("Failed to verify public key: "+i)}if(!e)return this.error("The signature from the sender was invalid.");let n;try{n=await window.crypto.subtle.importKey("raw",t.publicKey,{name:"ECDH",namedCurve:"P-256"},!1,[])}catch(i){return this.error("Failed to import public key: "+i)}await this.sendHandshakeResponse();try{this.sharedKey=await window.crypto.subtle.deriveKey({name:"ECDH",public:n},this.keyPair.privateKey,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])}catch(i){return this.error("Failed to derive key: "+i)}}close(){this.webSocket.readyState===this.webSocket.OPEN&&this.sendJSON({type:"leave"})}error(t){this.close(),this.errorCallback(t)}async sendHandshakeResponse(){if(!this.HMACKey)return this.error("HMAC key is not valid.");if(!this.keyPair)return this.error("Key pair is not valid.");let t;try{t=new Uint8Array(await window.crypto.subtle.exportKey("raw",this.keyPair.publicKey))}catch(o){return this.error("Failed to export public key: "+o)}let e;try{e=new Uint8Array(await window.crypto.subtle.sign("HMAC",this.HMACKey,t))}catch(o){return this.error("Failed to export HMAC key: "+o)}const i=Packet.encode({handshakeResponse:{publicKey:t,signature:e}}).finish();this.send(i)}async sendJSON(t){this.webSocket.send(JSON.stringify(t))}async send(t){const e=new Uint8Array([this.DESTINATION]);if(this.sharedKey){const n=window.crypto.getRandomValues(new Uint8Array(this.IV_SIZE));try{const i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},this.sharedKey,t),o=new Uint8Array(e.byteLength+n.byteLength+i.byteLength);o.set(e),o.set(n,e.length),o.set(new Uint8Array(i),n.length+e.length),this.webSocket.send(o)}catch(i){return this.error("Failed to encrypt: "+i)}}else{const n=new Uint8Array(e.byteLength+t.byteLength);n.set(e),n.set(t,e.length),this.webSocket.send(n)}}}const Receiver=()=>{let r=[],t,e,n,i;const[o,s]=createSignal({type:"loading",message:"Attempting to connect..."}),l=p=>{const y=Packet.decode(p);switch(y.value){case"list":return u(y.list);case"chunk":return h(y.chunk)}},a=p=>{s({type:"error",message:p})},c=()=>{if(o().type!=="transferFileCompleted")return d.error("File transfer was interrupted because the sender left.")},u=p=>{if(!p.entries)return d.error("Expected list entires to be valid.");for(const y of p.entries){const[b,m]=createSignal(0);r.push({name:y.name,index:y.index,size:y.size,progress:b,setProgress:m,file:void 0})}t=0,e=0,n=0,i=[],s({type:"transferFile"})},h=p=>{const y=r[t];if(!y)return d.error("Chunk packet does not match a given index.");i.push(p.chunk),e+=p.chunk.byteLength,y.setProgress(e/y.size*100>>0),(y.progress()===100||y.progress()-n>1)&&w(y),y.size===e&&f(y)},f=p=>{const y=new Blob(i),b=document.createElement("a");document.body.appendChild(b);const m=window.URL.createObjectURL(y);b.href=m,b.download=p.name,b.click(),window.URL.revokeObjectURL(m),t++,e=0,n=0,i=[],t===r.length&&s({type:"transferFileCompleted"})},w=p=>{n=p.progress();const b=Packet.encode({progress:{index:p.index,progress:n}}).finish();d.send(b)},d=new NetworkReceiver("wss://vldr.org:8080/relay",location.hash.replace("#",""),l,a,c);return createComponent(Switch,{get children(){return[createComponent(Match,{get when(){return o().type==="error"},get children(){return createComponent(ErrorPage,{get message(){return o().message}})}}),createComponent(Match,{get when(){return o().type==="loading"},get children(){return createComponent(LoadingPage,{get message(){return o().message}})}}),createComponent(Match,{get when(){return o().type==="transferFile"},get children(){return createComponent(TransferFilePage,{files:r})}}),createComponent(Match,{get when(){return o().type==="transferFileCompleted"},get children(){return createComponent(TransferFileCompletedPage,{})}})]}})},App=()=>createComponent(Show,{get when(){return location.hash},get fallback(){return createComponent(Sender,{})},get children(){return createComponent(Receiver,{})}}),index="",root=document.getElementById("root");render(()=>createComponent(App,{}),root);
